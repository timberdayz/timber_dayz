# Shopee è´¢åŠ¡è¡¨ç°æ•°æ®åˆ†æé…ç½®
# åŸºäºæµé‡è¡¨ç°æ¨¡æ¿ï¼Œé€‚é…è´¢åŠ¡è¡¨ç°é¡µé¢

metadata:
  name: "è´¢åŠ¡è¡¨ç°"
  type: "finance"
  version: "1.0.0"
  description: "Shopee è´¢åŠ¡è¡¨ç°æ•°æ®åˆ†æé¡µé¢é…ç½®"
  url_path: "/datacenter/finance/performance"

# é¡µé¢å¯¼èˆªé…ç½®
navigation:
  base_url: "https://seller.shopee.cn"
  path: "/datacenter/finance/performance"
  query_params:
    - "cnsc_shop_id"
  
  # é¡µé¢å°±ç»ªæ¢é’ˆï¼ˆè´¢åŠ¡è¡¨ç°ç‰¹æœ‰ï¼‰
  ready_probes:
    - "[class*='chart']"
    - ".finance-performance-container"
    - "div:has-text('è´¢åŠ¡åˆ†æ')"
    - "div:has-text('è´¢åŠ¡è¡¨ç°')"
    - "div:has-text('æ”¶å…¥')"
    - "div:has-text('æ”¯å‡º')"
    - ".data-table"
    - ".finance-metrics"

# æ—¥æœŸé€‰æ‹©å™¨é…ç½®ï¼ˆç»§æ‰¿æµé‡è¡¨ç°é…ç½®ï¼‰
date_picker:
  # æ‰“å¼€æ—¥æœŸé€‰æ‹©å™¨çš„è§¦å‘å™¨
  open_selectors:
    - "div.bi-date-input.track-click-open-time-selector"
    - "div.bi-date-input"
    - "div.date-picker-trigger"
    - ".date-range-picker"
    - "[data-testid*='date']"
    - "div:has-text('ç»Ÿè®¡æ—¶é—´')"
    - "div:has-text('æ—¶é—´èŒƒå›´')"
    - "div:has-text('ç»“ç®—æ—¶é—´')"
    - ".time-selector"
  
  # æ—¥æœŸé¢æ¿å®¹å™¨
  panel_selectors:
    - ".eds-date-selector-panel"
    - ".eds-date-picker__dropdown"
    - ".eds-dropdown__content:has(.eds-date-shortcut-item)"
    - ".eds-date-range-panel"
    - "div:has(.eds-date-shortcut-item__text)"
    - "div:has-text('æ˜¨å¤©')"
  
  # å¿«æ·æ—¶é—´é€‰é¡¹ï¼ˆè´¢åŠ¡å¯èƒ½æœ‰ç‰¹æ®Šå‘¨æœŸï¼‰
  quick_options:
    yesterday:
      - "æ˜¨å¤©"
      - "æ˜¨æ—¥"
      - "Yesterday"
    last_7_days:
      - "è¿‡å»7å¤©"
      - "è¿‡å» 7 å¤©"
      - "è¿‡å»7"
      - "æœ€è¿‘7å¤©"
      - "æœ€è¿‘ 7 å¤©"
      - "7å¤©"
      - "7 å¤©"
      - "Last 7 days"
    last_30_days:
      - "è¿‡å»30å¤©"
      - "è¿‡å» 30 å¤©"
      - "è¿‡å»30"
      - "æœ€è¿‘30å¤©"
      - "æœ€è¿‘ 30 å¤©"
      - "30å¤©"
      - "30 å¤©"
      - "Last 30 days"
    this_month:
      - "æœ¬æœˆ"
      - "è¿™æœˆ"
      - "å½“æœˆ"
      - "This Month"
    last_month:
      - "ä¸Šæœˆ"
      - "ä¸Šä¸ªæœˆ"
      - "Last Month"
  
  # å¿«æ·é¡¹é€‰æ‹©å™¨æ¨¡æ¿
  option_selectors:
    - ".eds-date-shortcut-item__text:has-text('{option}')"
    - ".eds-date-shortcut-item:has-text('{option}')"
    - "li:has-text('{option}')"
    - "span:has-text('{option}')"
    - "button:has-text('{option}')"
    - "div:has-text('{option}')"

# æ•°æ®å¯¼å‡ºé…ç½®
export:
  # å¯¼å‡ºæŒ‰é’®é€‰æ‹©å™¨ï¼ˆè´¢åŠ¡è¡¨ç°å¯èƒ½æœ‰ä¸åŒæ–‡æ¡ˆï¼‰
  button_selectors:
    - "button:has-text('å¯¼å‡ºæ•°æ®')"
    - "button:has-text('å¯¼å‡ºè´¢åŠ¡æ•°æ®')"
    - "button:has-text('å¯¼å‡ºè´¦å•')"
    - "button:has-text('Export Data')"
    - "button:has-text('Export Finance')"
    - "button:has-text('å¯¼å‡º')"
    - "button:has-text('Export')"
    - ".export-button"
    - "[data-testid*='export']"
    - "button[class*='export']"
  
  # ä¸‹è½½æŒ‰é’®é€‰æ‹©å™¨
  download_selectors:
    - "button:has-text('ä¸‹è½½')"
    - "button:has-text('Download')"
    - ".download-button"
    - "[data-testid*='download']"
  
  # å¯¼å‡ºçŠ¶æ€æ£€æµ‹
  status_selectors:
    - ".export-status"
    - ".download-progress"
    - "div:has-text('å¯¼å‡ºä¸­')"
    - "div:has-text('Exporting')"

# å¼¹çª—å¤„ç†é…ç½®
popups:
  # è´¢åŠ¡è¡¨ç°å¯èƒ½æœ‰ç‰¹æœ‰çš„æç¤ºå¼¹çª—
  notification_selectors:
    - ".notification-modal"
    - ".guide-modal"
    - ".tips-modal"
    - ".finance-guide-modal"
    - "div[role='dialog']:has-text('æç¤º')"
    - "div[role='dialog']:has-text('é€šçŸ¥')"
    - "div[role='dialog']:has-text('è´¢åŠ¡')"
    - "div[role='dialog']:has-text('ç»“ç®—')"
  
  # å…³é—­æŒ‰é’®é€‰æ‹©å™¨
  close_selectors:
    - "button:has-text('çŸ¥é“äº†')"
    - "button:has-text('ç¡®å®š')"
    - "button:has-text('å…³é—­')"
    - ".modal-close"
    - "[aria-label='Close']"
    - ".close-button"

# å½•åˆ¶æ¨¡å¼é…ç½®
recording:
  env_var: "PW_RECORD_DATE_PICKER"
  pause_message: "ğŸŸ¡ è°ƒè¯•æ¨¡å¼ï¼šå³å°†æ‰“å¼€ Playwright Inspector å¹¶æš‚åœåœ¨è´¢åŠ¡è¡¨ç°æ—¥æœŸé¢æ¿ï¼Œè¯·ç‚¹å‡» Recording åæ‰‹åŠ¨å®Œæˆæ“ä½œâ€¦"
  pause_after: "date_panel_opened"

# éªŒè¯é…ç½®
validation:
  # æ—¶é—´èŒƒå›´éªŒè¯é€‰æ‹©å™¨
  time_display_selectors:
    - ".time-range-display"
    - ".date-range-text"
    - "span:has-text('GMT')"
    - ".selected-date-range"
  
  # è´¢åŠ¡æ•°æ®åŠ è½½éªŒè¯
  data_loaded_selectors:
    - ".chart-container"
    - ".finance-chart"
    - ".revenue-chart"
    - ".data-table tbody tr"
    - ".finance-metrics"
    - ".metrics-card"
    - "[class*='loaded']"

# é”™è¯¯å¤„ç†é…ç½®
error_handling:
  max_retries: 3
  retry_delay: 1000
  timeouts:
    navigation: 30000
    element_wait: 5000
    download_wait: 30000
  fallback_enabled: true
  fallback_selectors:
    date_picker: "input[type='date']"
    export_button: "button[class*='btn']"
