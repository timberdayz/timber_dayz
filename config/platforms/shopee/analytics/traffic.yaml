# Shopee æµé‡è¡¨ç°æ•°æ®åˆ†æé…ç½®
# å£°æ˜å¼é…ç½®æ¨¡æ¿ï¼Œæ”¯æŒé›¶ä»£ç æ¥å…¥æ–°å­ç±»å‹

metadata:
  name: "æµé‡è¡¨ç°"
  type: "traffic"
  version: "1.0.0"
  description: "Shopee æµé‡è¡¨ç°æ•°æ®åˆ†æé¡µé¢é…ç½®"
  url_path: "/datacenter/traffic/overview"

# é¡µé¢å¯¼èˆªé…ç½®
navigation:
  base_url: "https://seller.shopee.cn"
  path: "/datacenter/traffic/overview"
  query_params:
    - "cnsc_shop_id"
  
  # é¡µé¢å°±ç»ªæ¢é’ˆï¼ˆç¡®è®¤é¡µé¢åŠ è½½å®Œæˆï¼‰
  ready_probes:
    - "[class*='chart']"
    - ".traffic-overview-container"
    - "div:has-text('æµé‡åˆ†æ')"
    - ".data-table"

# æ—¥æœŸé€‰æ‹©å™¨é…ç½®
date_picker:
  # æ‰“å¼€æ—¥æœŸé€‰æ‹©å™¨çš„è§¦å‘å™¨
  open_selectors:
    - "div.bi-date-input.track-click-open-time-selector"
    - "div.bi-date-input"
    - "div.date-picker-trigger"
    - ".date-range-picker"
    - "[data-testid*='date']"
    - "div:has-text('ç»Ÿè®¡æ—¶é—´')"
    - ".time-selector"
  
  # æ—¥æœŸé¢æ¿å®¹å™¨ï¼ˆç­‰å¾…å‡ºç°ï¼‰
  panel_selectors:
    - ".eds-date-selector-panel"
    - ".eds-date-picker__dropdown"
    - ".eds-dropdown__content:has(.eds-date-shortcut-item)"
    - ".eds-date-range-panel"
    - "div:has(.eds-date-shortcut-item__text)"
    - "div:has-text('æ˜¨å¤©')"
  
  # å¿«æ·æ—¶é—´é€‰é¡¹ï¼ˆæ”¯æŒå¤šè¯­è¨€/å¤šå˜ä½“ï¼‰
  quick_options:
    yesterday:
      - "æ˜¨å¤©"
      - "æ˜¨æ—¥"
      - "Yesterday"
    last_7_days:
      - "è¿‡å»7å¤©"
      - "è¿‡å» 7 å¤©"
      - "è¿‡å»7"
      - "æœ€è¿‘7å¤©"
      - "æœ€è¿‘ 7 å¤©"
      - "7å¤©"
      - "7 å¤©"
      - "Last 7 days"
    last_30_days:
      - "è¿‡å»30å¤©"
      - "è¿‡å» 30 å¤©"
      - "è¿‡å»30"
      - "æœ€è¿‘30å¤©"
      - "æœ€è¿‘ 30 å¤©"
      - "30å¤©"
      - "30 å¤©"
      - "Last 30 days"
    this_week:
      - "æœ¬å‘¨"
      - "è¿™å‘¨"
      - "This Week"
    this_month:
      - "æœ¬æœˆ"
      - "è¿™æœˆ"
      - "This Month"
  
  # å¿«æ·é¡¹é€‰æ‹©å™¨æ¨¡æ¿
  option_selectors:
    - ".eds-date-shortcut-item__text:has-text('{option}')"
    - ".eds-date-shortcut-item:has-text('{option}')"
    - "li:has-text('{option}')"
    - "span:has-text('{option}')"
    - "button:has-text('{option}')"
    - "div:has-text('{option}')"

# æ•°æ®å¯¼å‡ºé…ç½®
export:
  # å¯¼å‡ºæŒ‰é’®é€‰æ‹©å™¨
  button_selectors:
    - "button:has-text('å¯¼å‡ºæ•°æ®')"
    - "button:has-text('Export Data')"
    - "button:has-text('å¯¼å‡º')"
    - "button:has-text('Export')"
    - ".export-button"
    - "[data-testid*='export']"
    - "button[class*='export']"
  
  # ä¸‹è½½æŒ‰é’®é€‰æ‹©å™¨ï¼ˆå¦‚æœæœ‰äºŒçº§ç¡®è®¤ï¼‰
  download_selectors:
    - "button:has-text('ä¸‹è½½')"
    - "button:has-text('Download')"
    - ".download-button"
    - "[data-testid*='download']"
  
  # å¯¼å‡ºçŠ¶æ€æ£€æµ‹
  status_selectors:
    - ".export-status"
    - ".download-progress"
    - "div:has-text('å¯¼å‡ºä¸­')"
    - "div:has-text('Exporting')"

# å¼¹çª—å¤„ç†é…ç½®
popups:
  # éœ€è¦å…³é—­çš„é€šçŸ¥/å¼•å¯¼å¼¹çª—
  notification_selectors:
    - ".notification-modal"
    - ".guide-modal"
    - ".tips-modal"
    - "div[role='dialog']:has-text('æç¤º')"
    - "div[role='dialog']:has-text('é€šçŸ¥')"
  
  # å…³é—­æŒ‰é’®é€‰æ‹©å™¨
  close_selectors:
    - "button:has-text('çŸ¥é“äº†')"
    - "button:has-text('ç¡®å®š')"
    - "button:has-text('å…³é—­')"
    - ".modal-close"
    - "[aria-label='Close']"
    - ".close-button"

# å½•åˆ¶æ¨¡å¼é…ç½®
recording:
  # ç¯å¢ƒå˜é‡å¼€å…³
  env_var: "PW_RECORD_DATE_PICKER"
  # æš‚åœç‚¹æè¿°
  pause_message: "ğŸŸ¡ è°ƒè¯•æ¨¡å¼ï¼šå³å°†æ‰“å¼€ Playwright Inspector å¹¶æš‚åœåœ¨æ—¥æœŸé¢æ¿ï¼Œè¯·ç‚¹å‡» Recording åæ‰‹åŠ¨å®Œæˆæ“ä½œâ€¦"
  # å½•åˆ¶æŒ‚ç‚¹ä½ç½®
  pause_after: "date_panel_opened"

# éªŒè¯é…ç½®
validation:
  # æ—¶é—´èŒƒå›´éªŒè¯é€‰æ‹©å™¨
  time_display_selectors:
    - ".time-range-display"
    - ".date-range-text"
    - "span:has-text('GMT')"
    - ".selected-date-range"
  
  # æ•°æ®åŠ è½½éªŒè¯
  data_loaded_selectors:
    - ".chart-container"
    - ".data-table tbody tr"
    - ".metrics-card"
    - "[class*='loaded']"

# é”™è¯¯å¤„ç†é…ç½®
error_handling:
  # é‡è¯•é…ç½®
  max_retries: 3
  retry_delay: 1000  # æ¯«ç§’
  
  # è¶…æ—¶é…ç½®
  timeouts:
    navigation: 30000
    element_wait: 5000
    download_wait: 30000
  
  # é™çº§ç­–ç•¥
  fallback_enabled: true
  fallback_selectors:
    date_picker: "input[type='date']"
    export_button: "button[class*='btn']"
