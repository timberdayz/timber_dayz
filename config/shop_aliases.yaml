# =============================================
# 店铺别名映射表 - 西虹ERP系统 v4.3.6
# =============================================
#
# 功能说明：
# 将妙手(miaoshou)ERP导出的口语化店铺名映射到我们系统的标准账号ID
#
# 使用场景：
# 妙手导出的订单数据包含"店铺"列，值如"菲律宾1店"、"3C店"等，
# 这些名称不规范且可能变化，需要映射到统一的标准账号ID用于报表聚合。
#
# 工作原理：
# 1. 订单入库时，保留原始"店铺"列到 store_label_raw 字段
# 2. 系统根据本配置文件，将 store_label_raw 映射到 aligned_account_id
# 3. 报表按 aligned_account_id 聚合，实现账号级销售数据统一
#
# 配置格式：
#   'miaoshou:<账号>:<站点>:<原始店铺名>': '<标准账号ID>'
#
# 说明：
# - <账号>: 采购账号（如"虾皮巴西_东朗照明主体"）
# - <站点>: 站点/国家（如"菲律宾"、"新加坡"）
# - <原始店铺名>: 妙手导出文件中的"店铺"列值（如"菲律宾1店"）
# - <标准账号ID>: 你为该店铺定义的统一ID（如"shopee_ph_1"）
#
# 匹配规则（系统自动尝试，优先级递减）：
# 1. 精确匹配: 账号 + 站点 + 店铺名
# 2. 宽松匹配: 账号 + 店铺名（忽略站点）
# 3. 最宽松: 仅店铺名（适用于全局唯一的店铺名）
#
# 注意事项：
# - 冒号(:)用于分隔字段，请勿在店铺名中使用冒号
# - 标准账号ID建议使用小写+下划线（如 shopee_ph_1）
# - 修改后需重启后端服务或调用回填API生效
# =============================================

shop_aliases:
  # ==================== 虾皮巴西账号 ====================
  # 菲律宾站点店铺
  'miaoshou:虾皮巴西_东朗照明主体:菲律宾:菲律宾1店': 'shopee_ph_1'
  'miaoshou:虾皮巴西_东朗照明主体:菲律宾:菲律宾2店': 'shopee_ph_2'
  'miaoshou:虾皮巴西_东朗照明主体:菲律宾:菲律宾3店': 'shopee_ph_3'
  
  # 新加坡站点店铺
  'miaoshou:虾皮巴西_东朗照明主体:新加坡:新加坡1店': 'shopee_sg_1'
  'miaoshou:虾皮巴西_东朗照明主体:新加坡:新加坡3店': 'shopee_sg_3'
  'miaoshou:虾皮巴西_东朗照明主体:新加坡:3C店': 'shopee_sg_3c'
  'miaoshou:虾皮巴西_东朗照明主体:新加坡:5店玩具': 'shopee_sg_toys'
  
  # 马来西亚站点店铺
  'miaoshou:虾皮巴西_东朗照明主体:马来:马来1店': 'shopee_my_1'
  'miaoshou:虾皮巴西_东朗照明主体:马来西亚:马来1店': 'shopee_my_1'  # 兼容不同站点名称
  
  # ==================== 其他账号示例 ====================
  # （根据你的实际账号补充）
  # 'miaoshou:虾皮新加坡账号:新加坡:新店1': 'shopee_sg_new_1'
  # 'miaoshou:TikTok账号:泰国:泰国主店': 'tiktok_th_main'
  
  # ==================== 全局映射（可选）====================
  # 如果某个店铺名在所有账号/站点都唯一，可以使用简化格式：
  # 'miaoshou:::旗舰店': 'flagship_store'
  # 说明：三个冒号前留空表示匹配所有账号和站点

# =============================================
# 快速添加新映射的步骤：
# =============================================
# 1. 找到对应的账号分组（如"虾皮巴西账号"）
# 2. 在该分组下添加新行，格式：
#    'miaoshou:<账号>:<站点>:<店铺名>': '<标准ID>'
# 3. 保存文件
# 4. 执行回填：python scripts/backfill_account_alignment.py
# 5. 查看结果：curl http://localhost:8001/api/account-alignment/stats
#
# 提示：
# - 可以先运行 python scripts/miaoshou_shop_alias_builder.py
#   自动提取所有出现过的店铺名，生成待填充的模板
# - 建议的命名规范：<平台>_<国家代码>_<店铺标识>
#   如：shopee_ph_1, shopee_sg_3c, tiktok_th_main
# =============================================

# =============================================
# 常见问题：
# =============================================
# Q: 修改后何时生效？
# A: 重启后端服务，或调用 POST /api/account-alignment/backfill
#
# Q: 如何查看哪些店铺名还没有映射？
# A: GET /api/account-alignment/suggestions?min_orders=1
#
# Q: 一个店铺名可以映射到多个账号ID吗？
# A: 可以，通过账号+站点区分。如：
#    '虾皮账号A:菲律宾:菲律宾1店' → shopee_ph_a_1
#    '虾皮账号B:菲律宾:菲律宾1店' → shopee_ph_b_1
#
# Q: 映射错了怎么办？
# A: 直接修改target_id，重新执行回填脚本即可（幂等操作）
# =============================================
