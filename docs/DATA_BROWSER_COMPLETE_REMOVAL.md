# æ•°æ®æµè§ˆå™¨åŠŸèƒ½å®Œå…¨ç§»é™¤è®°å½•

**ç‰ˆæœ¬**: v4.12.0  
**ç§»é™¤æ—¶é—´**: 2025-02-01  
**ç§»é™¤åŸå› **: æ•°æ®æµè§ˆå™¨åŠŸèƒ½ä¿®å¤å¤šæ¬¡ä»æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼ŒMetabaseæ˜¯æ›´ä¸“ä¸šçš„BIå·¥å…·

---

## âœ… å·²å®Œå…¨åˆ é™¤çš„æ–‡ä»¶

### å‰ç«¯æ–‡ä»¶ï¼ˆå·²åˆ é™¤ï¼‰
- âœ… `frontend/src/views/DataBrowser.vue` - æ•°æ®æµè§ˆå™¨ä¸»ç»„ä»¶
- âœ… `frontend/src/views/DataBrowserSimple.vue` - æ•°æ®æµè§ˆå™¨ç®€åŒ–ç‰ˆç»„ä»¶

### åç«¯æ–‡ä»¶ï¼ˆå·²åˆ é™¤ï¼‰
- âœ… `backend/routers/data_browser.py` - æ•°æ®æµè§ˆå™¨APIè·¯ç”±

---

## âœ… å·²æ¸…ç†çš„ä»£ç å¼•ç”¨

### å‰ç«¯æ¸…ç†

1. **è·¯ç”±é…ç½®** (`frontend/src/router/index.js`)
   - âœ… å·²æ³¨é‡Š `/data-browser` è·¯ç”±

2. **èœå•é…ç½®** (`frontend/src/config/menuGroups.js`)
   - âœ… å·²ç§»é™¤ `æ•°æ®æµè§ˆå™¨` èœå•é¡¹
   - âœ… å·²ç§»é™¤èœå•æ˜¾ç¤ºåç§°æ˜ å°„

3. **APIè°ƒç”¨** (`frontend/src/api/index.js`)
   - âœ… å·²åˆ é™¤ `getTables()` - è·å–æ•°æ®è¡¨åˆ—è¡¨
   - âœ… å·²åˆ é™¤ `queryData()` - æŸ¥è¯¢æ•°æ®è¡¨æ•°æ®
   - âœ… å·²åˆ é™¤ `getTableStats()` - è·å–è¡¨ç»Ÿè®¡ä¿¡æ¯
   - âœ… å·²åˆ é™¤ `getFieldMapping()` - è·å–å­—æ®µæ˜ å°„å…³ç³»
   - âœ… å·²åˆ é™¤ `getFieldUsage()` - è·å–å­—æ®µä½¿ç”¨é“¾è·¯
   - âœ… å·²åˆ é™¤ `exportData()` - å¯¼å‡ºæ•°æ®

4. **æƒé™é…ç½®** (`frontend/src/stores/user.js`)
   - âœ… å·²ç§»é™¤ `data-browser` æƒé™

5. **ç»„ä»¶å¼•ç”¨** (`frontend/src/components/common/SimpleAccountSwitcher.vue`)
   - âœ… å·²ç§»é™¤ `data-browser` æƒé™å¼•ç”¨ï¼ˆ2å¤„ï¼‰

### åç«¯æ¸…ç†

1. **APIè·¯ç”±** (`backend/main.py`)
   - âœ… å·²æ³¨é‡Š `data_browser` å¯¼å…¥
   - âœ… å·²æ³¨é‡Š `data_browser.router` æ³¨å†Œ

---

## ğŸ” éªŒè¯ç»“æœ

### æ–‡ä»¶åˆ é™¤éªŒè¯
```bash
# éªŒè¯æ–‡ä»¶å·²åˆ é™¤
ls frontend/src/views/DataBrowser*.vue  # åº”è¿”å›"æ‰¾ä¸åˆ°æ–‡ä»¶"
ls backend/routers/data_browser.py      # åº”è¿”å›"æ‰¾ä¸åˆ°æ–‡ä»¶"
```

### ä»£ç å¼•ç”¨éªŒè¯
- âœ… å‰ç«¯æ— ä»»ä½• `DataBrowser`ã€`data-browser`ã€`data_browser` å¼•ç”¨ï¼ˆé™¤æ³¨é‡Šå¤–ï¼‰
- âœ… åç«¯æ— ä»»ä½• `data_browser` å¼•ç”¨ï¼ˆé™¤æ³¨é‡Šå¤–ï¼‰

### åç«¯å¯¼å…¥éªŒè¯
```bash
python -c "from backend.main import app; print('OK')"
# åº”æˆåŠŸå¯¼å…¥ï¼Œæ— é”™è¯¯
```

---

## ğŸ“ æ›¿ä»£æ–¹æ¡ˆ

### Metabaseä½¿ç”¨æŒ‡å—

1. **å¯åŠ¨Metabase**ï¼š
   ```bash
   docker-compose -f docker-compose.metabase.yml up -d
   ```

2. **è®¿é—®åœ°å€**ï¼š
   - æœ¬åœ°è®¿é—®ï¼š`http://localhost:3000`

3. **è¿æ¥æ•°æ®åº“**ï¼š
   - ä¸»æœºï¼š`postgres`ï¼ˆDockerç½‘ç»œå†…ï¼‰æˆ–`localhost`ï¼ˆä»ä¸»æœºè®¿é—®ï¼‰
   - ç«¯å£ï¼š`5432`
   - æ•°æ®åº“ï¼š`xihong_erp`
   - ç”¨æˆ·å/å¯†ç ï¼šæ ¹æ®`.env`é…ç½®

4. **åŠŸèƒ½å¯¹æ¯”**ï¼š
   - âœ… æ•°æ®æŸ¥è¯¢ï¼šMetabaseæ”¯æŒSQLæŸ¥è¯¢å’Œå¯è§†åŒ–æŸ¥è¯¢æ„å»ºå™¨
   - âœ… æ•°æ®å¯è§†åŒ–ï¼šMetabaseæ”¯æŒå¤šç§å›¾è¡¨ç±»å‹å’ŒDashboard
   - âœ… æ•°æ®å¯¼å‡ºï¼šMetabaseæ”¯æŒCSVã€JSONã€XLSXç­‰æ ¼å¼å¯¼å‡º
   - âœ… æ•°æ®è´¨é‡åˆ†æï¼šMetabaseæ”¯æŒåˆ›å»ºæ•°æ®è´¨é‡æ£€æŸ¥Questionå’ŒDashboard

---

## âš ï¸ é‡è¦æç¤º

1. **æ‰€æœ‰æ–‡ä»¶å·²å®Œå…¨åˆ é™¤**ï¼š
   - ä¸å†ä¿ç•™ä»»ä½•æ•°æ®æµè§ˆå™¨ç›¸å…³æ–‡ä»¶
   - æ‰€æœ‰å¼•ç”¨å·²æ¸…ç†æˆ–æ³¨é‡Š
   - é¿å…åæœŸAgentè¯¯è§£

2. **Metabaseæ˜¯å”¯ä¸€çš„æ•°æ®æŸ¥è¯¢å·¥å…·**ï¼š
   - æ‰€æœ‰æ•°æ®æŸ¥è¯¢å’Œåˆ†æåº”ä½¿ç”¨Metabase
   - ä¸å†æä¾›æ•°æ®æµè§ˆå™¨åŠŸèƒ½

3. **å¦‚éœ€æ¢å¤**ï¼š
   - éœ€è¦ä»Gitå†å²ä¸­æ¢å¤æ–‡ä»¶
   - éœ€è¦é‡æ–°å¯ç”¨æ‰€æœ‰æ³¨é‡Šçš„ä»£ç 
   - ä¸å»ºè®®æ¢å¤ï¼ŒMetabaseåŠŸèƒ½æ›´å¼ºå¤§

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹Metabaseå®˜æ–¹æ–‡æ¡£ï¼šhttps://www.metabase.com/docs/
2. æ£€æŸ¥Metabaseå®¹å™¨çŠ¶æ€ï¼š`docker ps --filter "name=metabase"`
3. æŸ¥çœ‹Metabaseæ—¥å¿—ï¼š`docker logs xihong_erp_metabase`
4. è”ç³»ç³»ç»Ÿç®¡ç†å‘˜

