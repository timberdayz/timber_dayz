# Metabase Dashboard筛选器配置指南

## 概述

本文档说明如何在Metabase Dashboard中配置筛选器，实现动态数据过滤和交互。

## 筛选器类型

### 1. 日期范围筛选器（Date Range）

**用途**：筛选时间范围的数据

**配置步骤**：
1. 在Dashboard中点击筛选器图标（漏斗图标）
2. 点击 "+ 添加筛选器"
3. 选择 "日期范围"（Date Range）
4. 配置：
   - **字段**：选择 `sale_date`
   - **标签**：`日期范围`
   - **默认值**：最近30天
   - **应用到**：所有Question

**使用场景**：
- 查看最近7天的数据
- 查看本月数据
- 查看自定义日期范围

### 2. 平台筛选器（Multi-Select）

**用途**：筛选特定平台的数据

**配置步骤**：
1. 添加筛选器 → 选择 "多选"（Multi-Select）
2. 配置：
   - **字段**：`platform_code`
   - **标签**：`平台`
   - **默认值**：全部（或选择默认平台）
   - **应用到**：所有Question

**使用场景**：
- 只查看Shopee平台数据
- 同时查看Shopee和TikTok数据
- 对比不同平台数据

### 3. 店铺筛选器（Multi-Select）

**用途**：筛选特定店铺的数据

**配置步骤**：
1. 添加筛选器 → 选择 "多选"（Multi-Select）
2. 配置：
   - **字段**：`shop_name` 或 `shop_id`
   - **标签**：`店铺`
   - **默认值**：全部
   - **应用到**：所有Question

**使用场景**：
- 查看特定店铺的绩效
- 对比多个店铺数据
- 筛选特定国家/地区的店铺

### 4. 粒度切换筛选器（Single Select）

**用途**：切换时间粒度（日/周/月）

**配置步骤**：
1. 添加筛选器 → 选择 "单选"（Single Select）
2. 配置：
   - **字段**：自定义字段或使用Question参数
   - **标签**：`时间粒度`
   - **选项**：
     - `daily` - 按日
     - `weekly` - 按周
     - `monthly` - 按月
   - **默认值**：`daily`

**注意**：粒度切换需要在Question中配置时间分组，或使用不同的Question。

## 筛选器联动配置

### 配置Question联动

**用途**：点击图表元素时，自动筛选其他Question

**配置步骤**：
1. 在Dashboard中点击Question的设置图标（三个点）
2. 选择 "点击行为"（Click behavior）
3. 配置联动：
   - **点击店铺名称** → 筛选所有Question到该店铺
   - **点击平台** → 筛选所有Question到该平台
   - **点击日期** → 筛选所有Question到该日期

**示例配置**：
- 点击店铺名称 → 更新店铺筛选器 → 应用到所有Question
- 点击平台代码 → 更新平台筛选器 → 应用到所有Question

## 钻取配置

### 配置钻取路径

**用途**：从汇总数据钻取到明细数据

**配置步骤**：
1. 在Question中配置钻取
2. 设置钻取路径：
   - **GMV趋势** → 店铺级别 → 产品级别
   - **平台汇总** → 店铺明细 → 订单明细

**示例**：
- 点击GMV趋势图的某个点 → 显示该日期的店铺明细
- 点击店铺名称 → 显示该店铺的产品明细

## 筛选器最佳实践

### 1. 筛选器顺序

建议的筛选器顺序：
1. 日期范围（最重要，最常用）
2. 平台（业务维度）
3. 店铺（明细维度）
4. 其他筛选器

### 2. 默认值设置

- **日期范围**：最近30天（常用范围）
- **平台**：全部（或主要平台）
- **店铺**：全部（或主要店铺）

### 3. 筛选器位置

- 将常用筛选器放在Dashboard顶部
- 使用清晰的标签
- 提供筛选器说明（可选）

### 4. 性能优化

- 避免过多筛选器（建议不超过5个）
- 使用索引字段作为筛选器
- 配置合理的默认值，减少初始查询时间

## 高级配置

### 1. 筛选器依赖

**用途**：店铺筛选器依赖于平台筛选器

**配置**：
- 当选择平台后，店铺筛选器只显示该平台的店铺
- 使用Metabase的筛选器依赖功能

### 2. 筛选器验证

**用途**：确保筛选器值的有效性

**配置**：
- 设置最小/最大值（日期范围）
- 设置允许的值列表（平台、店铺）

### 3. 筛选器预设

**用途**：保存常用的筛选器组合

**配置**：
- 创建筛选器预设
- 快速应用预设筛选器

## 常见问题

### Q1: 筛选器不生效

**解决方案**：
1. 检查筛选器是否应用到Question
2. 检查字段名是否正确
3. 检查Question是否支持该筛选器类型

### Q2: 筛选器值不更新

**解决方案**：
1. 刷新Dashboard
2. 检查筛选器配置
3. 清除浏览器缓存

### Q3: 筛选器性能慢

**解决方案**：
1. 减少筛选器数量
2. 使用索引字段
3. 优化Question查询

## 下一步

完成筛选器配置后：

1. **测试筛选器功能**
   - 测试每个筛选器是否正常工作
   - 测试筛选器联动
   - 测试筛选器组合

2. **优化筛选器体验**
   - 调整筛选器顺序
   - 设置合理的默认值
   - 添加筛选器说明

3. **配置前端集成**
   - 在Vue前端中同步筛选器
   - 实现筛选器状态同步

## 相关文档

- `docs/METABASE_DASHBOARD_MANUAL_SETUP.md` - Dashboard创建指南
- `docs/METABASE_QUICK_START.md` - 快速开始指南

