# v4.11.5 新功能用户指南

## 📍 功能入口位置

### 1. 单文件数据同步（v4.11.5新增）

**入口位置**：字段映射审核页面 → 数据同步对话框

**操作步骤**：
1. 访问：左侧菜单 → **数据采集与管理** → **字段映射审核**
2. 点击页面上的 **"数据同步"** 按钮
3. 在数据同步对话框中，选择 **"单个文件"** 选项
4. 从下拉列表中选择要同步的文件
5. 点击 **"开始同步"** 按钮
6. 同步进度对话框会立即显示，实时显示同步进度
7. 同步完成后，可以在"任务日志"和"数据流转"标签页查看详细信息

**功能说明**：
- **单文件测试**：支持同步单个文件，提升测试效率
- **实时进度**：同步进度对话框立即显示，实时更新进度
- **详细日志**：同步完成后可查看任务日志和数据流转信息
- **取消功能**：支持在同步过程中点击"取消"按钮取消同步

**使用场景**：
- 测试单个文件的字段映射配置是否正确
- 验证数据同步流程是否正常
- 快速定位单个文件的数据问题

---

### 2. 原始数据层查看

**入口位置**：字段映射审核页面 → 数据同步进度对话框 → 任务日志标签页

**操作步骤**：
1. 访问：左侧菜单 → **数据采集与管理** → **字段映射审核**
2. 点击页面上的 **"数据同步"** 按钮，启动数据同步
3. 在同步进度对话框中，切换到 **"任务日志"** 标签页
4. 在任务日志表格中，每行文件都有一个 **"查看原始数据"** 按钮
5. 点击按钮后，会弹出 **"原始数据层查看"** 对话框

**功能说明**：
- **原始Excel数据**：查看从Excel文件读取的原始数据
- **Staging数据**：查看写入到staging表的数据（Raw层）
- **对比报告**：对比原始数据与Staging数据的差异

---

### 3. 数据流转追踪

**入口位置**：字段映射审核页面 → 数据同步进度对话框 → 数据流转标签页

**操作步骤**：
1. 访问：左侧菜单 → **数据采集与管理** → **字段映射审核**
2. 点击页面上的 **"数据同步"** 按钮，启动数据同步
3. 在同步进度对话框中，切换到 **"数据流转"** 标签页
4. 点击 **"刷新流转信息"** 按钮加载数据流转详情

**功能说明**：
- **流转汇总**：显示Raw层、Fact层、隔离区的数据统计
- **文件流转详情**：显示每个文件的数据流转状态
- **流转可视化**：通过流程图展示数据从Excel → Staging → Fact → MV的流转过程

---

### 4. 连带率指标

**入口位置**：业务概览页面

**操作步骤**：
1. 访问：左侧菜单 → **工作台** → **业务概览**
2. 向下滚动到 **"连带率趋势分析"** 部分
3. 选择平台、粒度（日度/周度/月度）、日期范围
4. 点击 **"刷新"** 按钮加载数据

**功能说明**：
- **趋势图表**：使用ECharts展示连带率趋势
- **统计摘要**：显示平均连带率、最高/最低连带率、总订单数
- **多平台支持**：可以按平台筛选查看不同平台的连带率

**计算公式**：
```
连带率 = 订单商品总数 / 订单总数
```

---

### 5. 平台对比功能

**入口位置**：通过API调用（目前没有专门的UI页面）

**API端点**：
- `GET /api/metrics/platform/comparison`
- 参数：`platforms`（平台列表）、`start_date`、`end_date`、`metrics`（指标列表）

**功能说明**：
- 对比多个平台的GMV、订单数、连带率、转化率、客单价等指标
- 支持平台排名和趋势对比
- 返回JSON格式数据，可用于自定义报表

**使用建议**：
- 可以通过浏览器开发者工具调用API
- 或者在前端页面中集成此功能（需要开发）

---

### 5. 数据一致性验证

**入口位置**：左侧菜单 → **数据采集与管理** → **数据一致性验证**

**操作步骤**：
1. 访问：左侧菜单 → **数据采集与管理** → **数据一致性验证**
2. 选择功能模块（三个卡片）：
   - **跨平台一致性检查**：检查同一店铺在不同平台的数据一致性
   - **计算数据验证**：验证C类计算数据与B类源数据的一致性
   - **异常数据检测**：使用统计方法检测异常数据点
3. 填写参数后点击"开始检查"/"开始验证"/"开始检测"
4. 查看结果：检查结果会以表格和统计摘要的形式展示

**功能说明**：
- **跨平台一致性检查**：
  - 检查同一店铺在不同平台（Shopee、TikTok、Amazon、妙手ERP）的数据是否一致
  - 检查指标：GMV、订单数、连带率等
  - 显示一致性评分（0-100%）和各平台的偏差百分比
- **计算数据验证**：
  - 验证系统计算的C类数据（如转化率、连带率）是否与B类源数据匹配
  - 显示计算值与源值的差异和差异百分比
  - 帮助发现计算逻辑错误
- **异常数据检测**：
  - 使用Z-score统计方法检测异常数据点
  - 支持检测GMV、订单数、客单价、转化率、连带率等指标
  - 可设置阈值（默认3.0），值越大检测越严格
  - 显示异常日期、数值、Z-score和严重程度

**注意事项**：
- 该功能需要管理员权限
- 确保已同步相关平台和日期的数据
- 异常检测的阈值建议使用默认值3.0，可根据业务需求调整

---

## 🎯 快速访问路径总结

| 功能 | 入口路径 | 页面位置 |
|------|---------|---------|
| **单文件数据同步** | 字段映射审核 → 数据同步 → 选择"单个文件" | 对话框 |
| **原始数据层查看** | 字段映射审核 → 数据同步 → 任务日志 → 查看原始数据 | 对话框 |
| **数据流转追踪** | 字段映射审核 → 数据同步 → 数据流转 | 对话框标签页 |
| **连带率指标** | 业务概览 → 连带率趋势分析 | 页面中部 |
| **平台对比** | API调用 | 无UI（需开发） |
| **数据一致性验证** | 数据采集与管理 → 数据一致性验证 | 独立页面 |

---

## 📝 注意事项

1. **单文件数据同步**功能可以用于快速测试单个文件的同步流程
2. **原始数据层查看**和**数据流转追踪**功能需要在数据同步过程中或同步完成后使用
3. **连带率指标**需要先有订单数据才能显示图表（注意：v4.11.5已移除业务概览页面的"连带率趋势分析"图表，因为KPI中已显示连带率）
4. **平台对比**目前只有API接口，没有UI界面
5. **数据一致性验证**现在有完整的UI界面，可以直接使用

---

## 🚀 后续优化建议

1. **平台对比功能**：建议在业务概览页面或新建专门的"平台对比"页面
2. **数据一致性验证**：建议在数据浏览器或新建"数据质量"页面中集成
3. **统一入口**：可以考虑在"数据采集与管理"菜单下新增"数据质量"子菜单

---

**版本**：v4.11.5  
**更新时间**：2025-11-18

