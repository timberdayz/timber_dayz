# åŒæ­¥æ•°æ®æ ¸å¿ƒæµç¨‹è¯¦è§£ï¼ˆè¡¨å¤´å¤„ç†é‡ç‚¹åˆ†æï¼‰

**ç‰ˆæœ¬**: v4.9.3  
**æ›´æ–°æ—¶é—´**: 2025-11-08  
**ç›®çš„**: è¯¦ç»†æ¢³ç†åŒæ­¥æ•°æ®æµç¨‹ï¼Œé‡ç‚¹åˆ†æè¡¨å¤´å¤„ç†é—®é¢˜

---

## ğŸ“Š å®Œæ•´æµç¨‹æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è‡ªåŠ¨åŒæ­¥æ•°æ®æµç¨‹ï¼ˆå®Œæ•´ç‰ˆï¼‰                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å§‹ï¼ˆç”¨æˆ·ç‚¹å‡»"å¼€å§‹åŒæ­¥"ï¼‰
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æŸ¥è¯¢å¾…å…¥åº“æ–‡ä»¶â”‚
â”‚ â€¢ status='pending'â”‚
â”‚ â€¢ å¹³å°/æ•°æ®åŸŸç­›é€‰â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æŸ¥æ‰¾æ¨¡æ¿      â”‚
â”‚ â€¢ TemplateMatcherâ”‚
â”‚ â€¢ ä¸‰çº§é™çº§åŒ¹é…   â”‚
â”‚ â€¢ è·å–header_row â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. é¢„è§ˆæ–‡ä»¶      â”‚ âš ï¸ è¡¨å¤´å¤„ç†å…³é”®ç‚¹1
â”‚ â€¢ ä½¿ç”¨template.header_rowâ”‚
â”‚ â€¢ ExcelParser.read_excelâ”‚
â”‚ â€¢ è‡ªåŠ¨æ£€æµ‹è¡¨å¤´è¡Œ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. åº”ç”¨æ¨¡æ¿æ˜ å°„  â”‚
â”‚ â€¢ apply_template_to_columnsâ”‚
â”‚ â€¢ åŒ¹é…åˆ—å       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. è°ƒç”¨ingest APIâ”‚ âš ï¸ è¡¨å¤´å¤„ç†å…³é”®ç‚¹2
â”‚ â€¢ ä¼ é€’header_rowâ”‚
â”‚ â€¢ ä¼ é€’mappings   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. ingesté‡æ–°è¯»å–â”‚ âš ï¸ è¡¨å¤´å¤„ç†å…³é”®ç‚¹3
â”‚ â€¢ ä½¿ç”¨header_rowâ”‚
â”‚ â€¢ å®Œæ•´æ–‡ä»¶è¯»å–   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. åº”ç”¨å­—æ®µæ˜ å°„  â”‚
â”‚ â€¢ åŸå§‹åˆ—åâ†’æ ‡å‡†å­—æ®µâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. æ•°æ®éªŒè¯å’Œå…¥åº“â”‚
â”‚ â€¢ validate_product_metricsâ”‚
â”‚ â€¢ upsert_product_metricsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
        ç»“æŸ
```

---

## ğŸ”´ è¡¨å¤´å¤„ç†å…³é”®é—®é¢˜åˆ†æ

### é—®é¢˜1ï¼šheader_rowå‚æ•°æ ¼å¼ä¸ä¸€è‡´

#### è‡ªåŠ¨åŒæ­¥é¢„è§ˆé˜¶æ®µï¼ˆauto_ingest_orchestrator.py:151ï¼‰

```python
# ç¬¬148è¡Œï¼šè·å–header_row
header_row = template.header_row if template and template.header_row is not None else 0

# ç¬¬151è¡Œï¼šç›´æ¥ä½¿ç”¨header_row
df = ExcelParser.read_excel(file_path, header=header_row, nrows=100)
```

**é—®é¢˜**ï¼š
- `template.header_row`æ˜¯**0-based**ï¼ˆæ•°æ®åº“å®šä¹‰ï¼š`0-basedï¼Œé»˜è®¤0`ï¼‰
- `ExcelParser.read_excel`çš„`header`å‚æ•°ä¹Ÿæ˜¯**0-based**ï¼ˆpandasæ ‡å‡†ï¼‰
- âœ… **è¿™é‡Œæ˜¯ä¸€è‡´çš„**ï¼Œæ²¡æœ‰é—®é¢˜

#### ingest APIé˜¶æ®µï¼ˆfield_mapping.py:990-994ï¼‰

```python
# ç¬¬945è¡Œï¼šè·å–header_row
header_row = ingest_data.get("header_row", 1)  # âš ï¸ é»˜è®¤å€¼æ˜¯1ï¼
if header_row is None:
    header_row = 1

# ç¬¬990-994è¡Œï¼šè½¬æ¢headerå‚æ•°
if header_row == 0:
    header_param = None
else:
    header_param = header_row - 1  # âš ï¸ å‡1ï¼
```

**é—®é¢˜**ï¼š
- ingest APIçš„é»˜è®¤å€¼æ˜¯`1`ï¼ˆ1-basedï¼‰
- å¦‚æœ`header_row=1`ï¼Œè½¬æ¢ä¸º`header_param=0`ï¼ˆ0-basedï¼‰
- å¦‚æœ`header_row=0`ï¼Œä½¿ç”¨`header_param=None`ï¼ˆæ— è¡¨å¤´ï¼‰

**ä¸ä¸€è‡´ç‚¹**ï¼š
1. âš ï¸ **é»˜è®¤å€¼ä¸ä¸€è‡´**ï¼šè‡ªåŠ¨åŒæ­¥ä½¿ç”¨`0`ï¼Œingest APIä½¿ç”¨`1`
2. âš ï¸ **è½¬æ¢é€»è¾‘**ï¼šingest APIä¼šå‡1ï¼Œä½†è‡ªåŠ¨åŒæ­¥ç›´æ¥ä¼ é€’

---

### é—®é¢˜2ï¼šè¡¨å¤´è¡Œè‡ªåŠ¨æ£€æµ‹é€»è¾‘

#### è‡ªåŠ¨åŒæ­¥çš„è‡ªåŠ¨æ£€æµ‹ï¼ˆauto_ingest_orchestrator.py:159-181ï¼‰

```python
# å¦‚æœæ˜ å°„ä¸ºç©ºæˆ–åŒ¹é…ç‡å¾ˆä½ï¼Œå°è¯•è‡ªåŠ¨æ£€æµ‹è¡¨å¤´è¡Œ
if not initial_mapping or len(initial_mapping) < len(columns) * 0.3:
    logger.warning(f"[AutoIngest] è¡¨å¤´è¡Œ{header_row}åŒ¹é…å¤±è´¥...")
    # å°è¯•è¡¨å¤´è¡Œ0-5
    for test_header in [0, 1, 2, 3, 4, 5]:
        if test_header == header_row:
            continue  # è·³è¿‡å·²å°è¯•çš„
        try:
            test_df = ExcelParser.read_excel(file_path, header=test_header, nrows=10)
            test_columns = test_df.columns.tolist()
            # å°è¯•åº”ç”¨æ¨¡æ¿
            test_mapping = self.template_matcher.apply_template_to_columns(
                template, test_columns
            )
            # å¦‚æœåŒ¹é…æˆåŠŸï¼ˆè‡³å°‘åŒ¹é…30%çš„åˆ—ï¼‰ï¼Œä½¿ç”¨è¿™ä¸ªè¡¨å¤´è¡Œ
            if test_mapping and len(test_mapping) >= len(test_columns) * 0.3:
                logger.info(f"[AutoIngest] è‡ªåŠ¨æ£€æµ‹åˆ°è¡¨å¤´è¡Œ: {test_header}...")
                df = test_df
                columns = test_columns
                header_row = test_header  # âš ï¸ æ›´æ–°header_row
                break
```

**é—®é¢˜**ï¼š
1. âœ… **è‡ªåŠ¨æ£€æµ‹é€»è¾‘æ­£ç¡®**ï¼šå¦‚æœæ¨¡æ¿çš„header_rowä¸åŒ¹é…ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹
2. âš ï¸ **æ£€æµ‹èŒƒå›´**ï¼šåªæ£€æµ‹0-5è¡Œï¼Œå¯èƒ½ä¸å¤Ÿ
3. âš ï¸ **åŒ¹é…é˜ˆå€¼**ï¼š30%å¯èƒ½å¤ªä½ï¼Œå¯¼è‡´è¯¯åŒ¹é…

---

### é—®é¢˜3ï¼šingest APIé‡æ–°è¯»å–æ–‡ä»¶

#### ingest APIé‡æ–°è¯»å–ï¼ˆfield_mapping.py:996-1002ï¼‰

```python
# è¯»å–å®Œæ•´æ–‡ä»¶ï¼ˆä¸é™åˆ¶è¡Œæ•°ï¼‰
df = ExcelParser.read_excel(
    safe_path,
    header=header_param,  # âš ï¸ ä½¿ç”¨è½¬æ¢åçš„header_param
    nrows=None  # ä¸é™åˆ¶è¡Œæ•°ï¼Œè¯»å–å…¨éƒ¨æ•°æ®
)
```

**é—®é¢˜**ï¼š
1. âš ï¸ **é‡æ–°è¯»å–æ–‡ä»¶**ï¼šè™½ç„¶ä¼ é€’äº†header_rowï¼Œä½†ingest APIä¼šé‡æ–°è¯»å–æ–‡ä»¶
2. âš ï¸ **å‚æ•°è½¬æ¢**ï¼šheader_rowä¼šè¢«è½¬æ¢ä¸ºheader_paramï¼ˆå‡1ï¼‰
3. âš ï¸ **ä¸ä¸€è‡´é£é™©**ï¼šå¦‚æœè‡ªåŠ¨åŒæ­¥æ£€æµ‹åˆ°çš„header_rowå’Œingest APIè½¬æ¢åçš„ä¸ä¸€è‡´ï¼Œä¼šå¯¼è‡´åˆ—åä¸åŒ¹é…

---

## ğŸ” æ‰‹åŠ¨å…¥åº“ vs è‡ªåŠ¨åŒæ­¥å¯¹æ¯”

### æ‰‹åŠ¨å…¥åº“æµç¨‹

```
1. ç”¨æˆ·é€‰æ‹©æ–‡ä»¶
   â”‚
   â–¼
2. å‰ç«¯è°ƒç”¨/preview API
   â€¢ ä½¿ç”¨ç”¨æˆ·é€‰æ‹©çš„header_rowï¼ˆå‰ç«¯è®¾ç½®ï¼‰
   â€¢ è¿”å›é¢„è§ˆæ•°æ®
   â”‚
   â–¼
3. ç”¨æˆ·ç¡®è®¤æ˜ å°„
   â€¢ å¯ä»¥æ‰‹åŠ¨è°ƒæ•´header_row
   â€¢ å¯ä»¥æ‰‹åŠ¨è°ƒæ•´å­—æ®µæ˜ å°„
   â”‚
   â–¼
4. è°ƒç”¨/ingest API
   â€¢ ä¼ é€’ç”¨æˆ·ç¡®è®¤çš„header_row
   â€¢ ä¼ é€’ç”¨æˆ·ç¡®è®¤çš„mappings
   â”‚
   â–¼
5. ingesté‡æ–°è¯»å–æ–‡ä»¶
   â€¢ ä½¿ç”¨header_rowï¼ˆè½¬æ¢åï¼‰
   â€¢ åº”ç”¨mappings
   â”‚
   â–¼
6. æ•°æ®å…¥åº“
```

**ç‰¹ç‚¹**ï¼š
- âœ… ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨è°ƒæ•´header_row
- âœ… ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨è°ƒæ•´å­—æ®µæ˜ å°„
- âœ… é¢„è§ˆå’Œå…¥åº“ä½¿ç”¨ç›¸åŒçš„header_rowï¼ˆç”¨æˆ·ç¡®è®¤çš„ï¼‰

### è‡ªåŠ¨åŒæ­¥æµç¨‹

```
1. è‡ªåŠ¨åŒæ­¥é€‰æ‹©æ–‡ä»¶
   â”‚
   â–¼
2. æŸ¥æ‰¾æ¨¡æ¿
   â€¢ è·å–template.header_rowï¼ˆ0-basedï¼‰
   â”‚
   â–¼
3. é¢„è§ˆæ–‡ä»¶ï¼ˆè‡ªåŠ¨åŒæ­¥å†…éƒ¨ï¼‰
   â€¢ ä½¿ç”¨template.header_rowï¼ˆ0-basedï¼‰
   â€¢ å¦‚æœåŒ¹é…å¤±è´¥ï¼Œè‡ªåŠ¨æ£€æµ‹0-5è¡Œ
   â€¢ æ›´æ–°header_rowä¸ºæ£€æµ‹åˆ°çš„å€¼
   â”‚
   â–¼
4. åº”ç”¨æ¨¡æ¿æ˜ å°„
   â€¢ ä½¿ç”¨æ£€æµ‹åˆ°çš„åˆ—å
   â€¢ ç”Ÿæˆfield_mapping
   â”‚
   â–¼
5. è°ƒç”¨/ingest API
   â€¢ ä¼ é€’æ£€æµ‹åˆ°çš„header_rowï¼ˆ0-basedï¼‰
   â€¢ ä¼ é€’field_mapping
   â”‚
   â–¼
6. ingesté‡æ–°è¯»å–æ–‡ä»¶
   â€¢ header_rowè½¬æ¢ä¸ºheader_paramï¼ˆå‡1ï¼‰
   â€¢ å¦‚æœheader_row=0ï¼Œä½¿ç”¨None
   â€¢ å¦‚æœheader_row=1ï¼Œä½¿ç”¨0
   â”‚
   â–¼
7. åº”ç”¨å­—æ®µæ˜ å°„
   â€¢ ä½¿ç”¨é‡æ–°è¯»å–çš„åˆ—å
   â€¢ åº”ç”¨field_mapping
   â”‚
   â–¼
8. æ•°æ®å…¥åº“
```

**é—®é¢˜**ï¼š
- âš ï¸ **ä¸¤æ¬¡è¯»å–æ–‡ä»¶**ï¼šé¢„è§ˆæ—¶è¯»å–ä¸€æ¬¡ï¼Œingestæ—¶é‡æ–°è¯»å–ä¸€æ¬¡
- âš ï¸ **å‚æ•°è½¬æ¢ä¸ä¸€è‡´**ï¼šé¢„è§ˆæ—¶ä½¿ç”¨0-basedï¼Œingestæ—¶è½¬æ¢ä¸º0-basedï¼ˆä½†é€»è¾‘ä¸åŒï¼‰
- âš ï¸ **åˆ—åå¯èƒ½ä¸åŒ¹é…**ï¼šå¦‚æœä¸¤æ¬¡è¯»å–çš„åˆ—åä¸ä¸€è‡´ï¼Œæ˜ å°„ä¼šå¤±è´¥

---

## ğŸ¯ æ ¸å¿ƒé—®é¢˜æ€»ç»“

### é—®é¢˜1ï¼šheader_rowå‚æ•°æ ¼å¼æ··ä¹±

**è¡¨ç°**ï¼š
- æ¨¡æ¿ä¸­ï¼š`header_row`æ˜¯0-basedï¼ˆé»˜è®¤0ï¼‰
- è‡ªåŠ¨åŒæ­¥é¢„è§ˆï¼šç›´æ¥ä½¿ç”¨`header_row`ï¼ˆ0-basedï¼‰
- ingest APIé»˜è®¤å€¼ï¼š`header_row=1`ï¼ˆ1-basedï¼Ÿï¼‰
- ingest APIè½¬æ¢ï¼š`header_row-1`ï¼ˆè½¬æ¢ä¸º0-basedï¼‰

**å½±å“**ï¼š
- å¦‚æœæ¨¡æ¿çš„`header_row=0`ï¼Œè‡ªåŠ¨åŒæ­¥ä¼ é€’`header_row=0`ï¼Œingest APIè½¬æ¢ä¸º`header_param=None`ï¼ˆæ— è¡¨å¤´ï¼‰
- å¦‚æœæ¨¡æ¿çš„`header_row=1`ï¼Œè‡ªåŠ¨åŒæ­¥ä¼ é€’`header_row=1`ï¼Œingest APIè½¬æ¢ä¸º`header_param=0`ï¼ˆç¬¬0è¡Œï¼‰

**ä¿®å¤å»ºè®®**ï¼š
1. âœ… **ç»Ÿä¸€header_rowæ ¼å¼**ï¼šå…¨éƒ¨ä½¿ç”¨0-based
2. âœ… **ä¿®å¤ingest APIé»˜è®¤å€¼**ï¼šä»`1`æ”¹ä¸º`0`
3. âœ… **ç®€åŒ–è½¬æ¢é€»è¾‘**ï¼šç›´æ¥ä½¿ç”¨header_rowï¼Œä¸éœ€è¦å‡1

### é—®é¢˜2ï¼šä¸¤æ¬¡è¯»å–æ–‡ä»¶å¯¼è‡´åˆ—åä¸ä¸€è‡´

**è¡¨ç°**ï¼š
- è‡ªåŠ¨åŒæ­¥é¢„è§ˆæ—¶è¯»å–æ–‡ä»¶ï¼Œè·å–åˆ—å
- ingest APIé‡æ–°è¯»å–æ–‡ä»¶ï¼Œå¯èƒ½è·å–ä¸åŒçš„åˆ—å
- å¦‚æœåˆ—åä¸ä¸€è‡´ï¼Œå­—æ®µæ˜ å°„ä¼šå¤±è´¥

**å½±å“**ï¼š
- å­—æ®µæ˜ å°„åŸºäºé¢„è§ˆæ—¶çš„åˆ—åï¼Œä½†ingestæ—¶åˆ—åå¯èƒ½ä¸åŒ
- å¯¼è‡´æ˜ å°„å¤±è´¥ï¼Œæ•°æ®æ— æ³•å…¥åº“

**ä¿®å¤å»ºè®®**ï¼š
1. âœ… **é¿å…ä¸¤æ¬¡è¯»å–**ï¼šingest APIåº”è¯¥ä½¿ç”¨é¢„è§ˆæ—¶ä¼ é€’çš„åˆ—å
2. âœ… **æˆ–è€…**ï¼šç¡®ä¿ä¸¤æ¬¡è¯»å–ä½¿ç”¨ç›¸åŒçš„header_rowå‚æ•°

### é—®é¢˜3ï¼šè‡ªåŠ¨æ£€æµ‹è¡¨å¤´è¡Œçš„é˜ˆå€¼å¤ªä½

**è¡¨ç°**ï¼š
- åŒ¹é…é˜ˆå€¼ï¼š30%ï¼ˆ`len(test_mapping) >= len(test_columns) * 0.3`ï¼‰
- å¯èƒ½å¯¼è‡´è¯¯åŒ¹é…

**å½±å“**ï¼š
- å¦‚æœæ–‡ä»¶æœ‰å¤šä¸ªç›¸ä¼¼è¡Œï¼Œå¯èƒ½åŒ¹é…åˆ°é”™è¯¯çš„è¡¨å¤´è¡Œ
- å¯¼è‡´å­—æ®µæ˜ å°„é”™è¯¯

**ä¿®å¤å»ºè®®**ï¼š
1. âœ… **æé«˜åŒ¹é…é˜ˆå€¼**ï¼šä»30%æé«˜åˆ°50%æˆ–æ›´é«˜
2. âœ… **å¢åŠ éªŒè¯**ï¼šåŒ¹é…åéªŒè¯æ•°æ®è´¨é‡

---

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šç»Ÿä¸€header_rowæ ¼å¼ï¼ˆæ¨èï¼‰

```python
# 1. ä¿®å¤ingest APIé»˜è®¤å€¼
header_row = ingest_data.get("header_row", 0)  # âœ… æ”¹ä¸º0
if header_row is None:
    header_row = 0  # âœ… æ”¹ä¸º0

# 2. ç®€åŒ–è½¬æ¢é€»è¾‘
# pandasçš„headerå‚æ•°å°±æ˜¯0-basedï¼Œç›´æ¥ä½¿ç”¨
header_param = header_row if header_row >= 0 else None
```

### æ–¹æ¡ˆ2ï¼šé¿å…ä¸¤æ¬¡è¯»å–æ–‡ä»¶

```python
# ingest APIåº”è¯¥ä½¿ç”¨é¢„è§ˆæ—¶ä¼ é€’çš„åˆ—åå’Œmappings
# ä¸éœ€è¦é‡æ–°è¯»å–æ–‡ä»¶ï¼Œç›´æ¥ä½¿ç”¨ä¼ é€’çš„æ•°æ®
```

### æ–¹æ¡ˆ3ï¼šæé«˜è‡ªåŠ¨æ£€æµ‹é˜ˆå€¼

```python
# æé«˜åŒ¹é…é˜ˆå€¼
if test_mapping and len(test_mapping) >= len(test_columns) * 0.5:  # âœ… ä»30%æé«˜åˆ°50%
    # ä½¿ç”¨è¿™ä¸ªè¡¨å¤´è¡Œ
```

---

## ğŸ“ éªŒè¯æ­¥éª¤

1. **æ£€æŸ¥æ¨¡æ¿header_rowå€¼**
   ```sql
   SELECT platform, data_domain, granularity, header_row 
   FROM field_mapping_templates 
   WHERE platform='miaoshou' AND data_domain='products';
   ```

2. **æ£€æŸ¥è‡ªåŠ¨åŒæ­¥æ—¥å¿—**
   - æŸ¥çœ‹è¡¨å¤´è¡Œæ£€æµ‹æ—¥å¿—
   - æŸ¥çœ‹å­—æ®µæ˜ å°„åŒ¹é…ç‡
   - æŸ¥çœ‹ingest APIçš„header_rowå‚æ•°

3. **å¯¹æ¯”æ‰‹åŠ¨å…¥åº“å’Œè‡ªåŠ¨åŒæ­¥**
   - ä½¿ç”¨ç›¸åŒçš„æ–‡ä»¶
   - å¯¹æ¯”header_rowå€¼
   - å¯¹æ¯”å­—æ®µæ˜ å°„ç»“æœ
   - å¯¹æ¯”å…¥åº“æ•°æ®é‡

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-08  
**ç»´æŠ¤è€…**: AI Agent

