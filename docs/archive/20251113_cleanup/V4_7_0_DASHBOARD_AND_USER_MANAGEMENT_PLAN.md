# å‰ç«¯æ•°æ®çœ‹æ¿å’Œç”¨æˆ·ç®¡ç†ç³»ç»Ÿè®¾è®¡è§„åˆ’ï¼ˆv4.7.0ï¼‰

**æ—¥æœŸ**: 2025-11-01  
**ç‰ˆæœ¬**: v4.7.0ï¼ˆè§„åˆ’ä¸­ï¼‰  
**çŠ¶æ€**: ğŸ“‹ è§„åˆ’é˜¶æ®µ

---

## ğŸ“‹ éœ€æ±‚æ¦‚è¿°

### ç”¨æˆ·éœ€æ±‚

1. **å‰ç«¯æ•°æ®çœ‹æ¿è®¾è®¡**
   - å„ç±»æ•°æ®çœ‹æ¿ï¼ˆé”€å”®ã€åº“å­˜ã€è´¢åŠ¡ç­‰ï¼‰
   - å®æ—¶æ•°æ®åŒæ­¥å’Œå±•ç¤º
   - å¤šç»´åº¦æ•°æ®åˆ†æå’Œå¯è§†åŒ–

2. **ç”¨æˆ·ç®¡ç†å’Œæƒé™ç³»ç»Ÿ**
   - å¤šè§’è‰²æ”¯æŒï¼ˆå¼€å‘è€…ã€ç®¡ç†å‘˜ã€ä¸»ç®¡ã€æ“ä½œå‘˜ï¼‰
   - æ³¨å†Œè´¦å·å’Œå®¡æ‰¹æµç¨‹
   - ç”µå­æµè®¾è®¡ï¼ˆå®¡æ‰¹æµç¨‹å¯è§†åŒ–ï¼‰

### è®¾è®¡ç›®æ ‡

- âœ… **ä¼ä¸šçº§ERPæ ‡å‡†**ï¼šå‚è€ƒSAPã€Oracle ERPè®¾è®¡
- âœ… **ç°ä»£åŒ–UI/UX**ï¼šä¸“ä¸šçº§æ•°æ®å¯è§†åŒ–ç•Œé¢
- âœ… **ç»†ç²’åº¦æƒé™æ§åˆ¶**ï¼šåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰
- âœ… **ç”µå­å®¡æ‰¹æµç¨‹**ï¼šå®Œæ•´çš„å®¡æ‰¹æµç¨‹å¯è§†åŒ–

---

## ğŸ¯ å‰ç«¯æ•°æ®çœ‹æ¿è®¾è®¡

### 1. çœ‹æ¿æ¶æ„è®¾è®¡

#### 1.1 çœ‹æ¿åˆ†ç±»

```
æ•°æ®çœ‹æ¿ç³»ç»Ÿ
â”œâ”€â”€ é”€å”®çœ‹æ¿ï¼ˆSales Dashboardï¼‰
â”‚   â”œâ”€â”€ é”€å”®æ¦‚è§ˆï¼ˆGMVã€è®¢å•æ•°ã€å®¢å•ä»·ï¼‰
â”‚   â”œâ”€â”€ é”€å”®è¶‹åŠ¿ï¼ˆæ—¥/å‘¨/æœˆè¶‹åŠ¿å›¾ï¼‰
â”‚   â”œâ”€â”€ åº—é“ºæ’åï¼ˆTop Nåº—é“ºï¼‰
â”‚   â”œâ”€â”€ äº§å“æ’åï¼ˆTop Näº§å“ï¼‰
â”‚   â””â”€â”€ åŒºåŸŸåˆ†æï¼ˆæŒ‰å›½å®¶/åœ°åŒºï¼‰
â”‚
â”œâ”€â”€ åº“å­˜çœ‹æ¿ï¼ˆInventory Dashboardï¼‰
â”‚   â”œâ”€â”€ åº“å­˜æ¦‚è§ˆï¼ˆæ€»åº“å­˜ã€ç¼ºè´§é¢„è­¦ï¼‰
â”‚   â”œâ”€â”€ åº“å­˜å‘¨è½¬ç‡
â”‚   â”œâ”€â”€ å®‰å…¨åº“å­˜é¢„è­¦
â”‚   â””â”€â”€ åº“å­˜åˆ†å¸ƒï¼ˆæŒ‰åº—é“º/äº§å“ï¼‰
â”‚
â”œâ”€â”€ è´¢åŠ¡çœ‹æ¿ï¼ˆFinance Dashboardï¼‰
â”‚   â”œâ”€â”€ è´¢åŠ¡æ¦‚è§ˆï¼ˆæ”¶å…¥ã€æˆæœ¬ã€åˆ©æ¶¦ï¼‰
â”‚   â”œâ”€â”€ P&LæŠ¥è¡¨ï¼ˆåˆ©æ¶¦è¡¨ï¼‰
â”‚   â”œâ”€â”€ ç°é‡‘æµåˆ†æ
â”‚   â”œâ”€â”€ è´¹ç”¨åˆ†æ
â”‚   â””â”€â”€ ç¨åŠ¡æŠ¥è¡¨
â”‚
â”œâ”€â”€ äº§å“çœ‹æ¿ï¼ˆProduct Dashboardï¼‰
â”‚   â”œâ”€â”€ äº§å“è¡¨ç°ï¼ˆæµè§ˆé‡ã€è½¬åŒ–ç‡ï¼‰
â”‚   â”œâ”€â”€ äº§å“æ’å
â”‚   â”œâ”€â”€ æ–°å“è¡¨ç°
â”‚   â””â”€â”€ äº§å“ç”Ÿå‘½å‘¨æœŸåˆ†æ
â”‚
â””â”€â”€ è¿è¥çœ‹æ¿ï¼ˆOperations Dashboardï¼‰
    â”œâ”€â”€ è¿è¥æŒ‡æ ‡ï¼ˆå®¢æœã€ç‰©æµã€è¥é”€ï¼‰
    â”œâ”€â”€ è¿è¥æ•ˆç‡åˆ†æ
    â””â”€â”€ è¿è¥æˆæœ¬åˆ†æ
```

#### 1.2 æŠ€æœ¯æ¶æ„

**å‰ç«¯æŠ€æœ¯æ ˆ**ï¼š
- Vue.js 3 + Composition API
- Element Plusï¼ˆUIç»„ä»¶åº“ï¼‰
- EChartsï¼ˆæ•°æ®å¯è§†åŒ–ï¼‰
- Piniaï¼ˆçŠ¶æ€ç®¡ç†ï¼‰
- Vue Routerï¼ˆè·¯ç”±ç®¡ç†ï¼‰

**åç«¯APIè®¾è®¡**ï¼š
- RESTful APIï¼ˆFastAPIï¼‰
- WebSocketï¼ˆå®æ—¶æ•°æ®æ¨é€ï¼‰
- ç¼“å­˜ç­–ç•¥ï¼ˆRedisï¼‰

**æ•°æ®åŒæ­¥æœºåˆ¶**ï¼š
- å®æ—¶åŒæ­¥ï¼ˆWebSocketæ¨é€ï¼‰
- å®šæ—¶åˆ·æ–°ï¼ˆæ¯5åˆ†é’Ÿï¼‰
- æ‰‹åŠ¨åˆ·æ–°ï¼ˆç”¨æˆ·è§¦å‘ï¼‰

### 2. çœ‹æ¿ç»„ä»¶è®¾è®¡

#### 2.1 é€šç”¨ç»„ä»¶

**KPIå¡ç‰‡ç»„ä»¶** (`KPICard.vue`)
```vue
<KPICard
  title="æ€»é”€å”®é¢"
  value="1,234,567"
  unit="CNY"
  trend="+12.5%"
  trendType="up"
  :loading="false"
/>
```

**å›¾è¡¨ç»„ä»¶** (`ChartCard.vue`)
```vue
<ChartCard
  title="é”€å”®è¶‹åŠ¿"
  type="line"
  :data="chartData"
  :options="chartOptions"
  height="300px"
/>
```

**æ•°æ®è¡¨æ ¼ç»„ä»¶** (`DataTable.vue`)
```vue
<DataTable
  :columns="columns"
  :data="tableData"
  :pagination="pagination"
  :loading="loading"
/>
```

**ç­›é€‰å™¨ç»„ä»¶** (`FilterBar.vue`)
```vue
<FilterBar
  :filters="filters"
  @filter-change="handleFilterChange"
/>
```

#### 2.2 çœ‹æ¿è·¯ç”±è®¾è®¡

```javascript
// frontend/src/router/index.js
{
  path: '/dashboard',
  name: 'Dashboard',
  component: () => import('@/views/Dashboard.vue'),
  children: [
    {
      path: 'sales',
      name: 'SalesDashboard',
      component: () => import('@/views/dashboard/SalesDashboard.vue'),
      meta: { requiresAuth: true, roles: ['developer', 'admin', 'supervisor', 'operator'] }
    },
    {
      path: 'inventory',
      name: 'InventoryDashboard',
      component: () => import('@/views/dashboard/InventoryDashboard.vue'),
      meta: { requiresAuth: true, roles: ['developer', 'admin', 'supervisor', 'operator'] }
    },
    {
      path: 'finance',
      name: 'FinanceDashboard',
      component: () => import('@/views/dashboard/FinanceDashboard.vue'),
      meta: { requiresAuth: true, roles: ['developer', 'admin', 'supervisor'] }
    },
    {
      path: 'product',
      name: 'ProductDashboard',
      component: () => import('@/views/dashboard/ProductDashboard.vue'),
      meta: { requiresAuth: true, roles: ['developer', 'admin', 'supervisor', 'operator'] }
    },
    {
      path: 'operations',
      name: 'OperationsDashboard',
      component: () => import('@/views/dashboard/OperationsDashboard.vue'),
      meta: { requiresAuth: true, roles: ['developer', 'admin', 'supervisor'] }
    }
  ]
}
```

### 3. æ•°æ®APIè®¾è®¡

#### 3.1 é”€å”®çœ‹æ¿API

```python
# backend/routers/dashboard.py

@router.get("/api/dashboard/sales/overview")
async def get_sales_overview(
    start_date: str,
    end_date: str,
    shop_ids: Optional[List[str]] = None,
    platform: Optional[str] = None,
    db: Session = Depends(get_db)
):
    """
    è·å–é”€å”®æ¦‚è§ˆæ•°æ®
    
    è¿”å›ï¼š
    {
        "gmv": 1234567.89,
        "order_count": 1234,
        "avg_order_value": 999.99,
        "growth_rate": 12.5,
        "trend": "up"  # up/down/stable
    }
    """
    pass

@router.get("/api/dashboard/sales/trend")
async def get_sales_trend(
    start_date: str,
    end_date: str,
    granularity: str = "daily",  # daily/weekly/monthly
    shop_ids: Optional[List[str]] = None,
    db: Session = Depends(get_db)
):
    """
    è·å–é”€å”®è¶‹åŠ¿æ•°æ®
    
    è¿”å›ï¼š
    {
        "dates": ["2025-01-01", "2025-01-02", ...],
        "values": [1000, 1200, ...],
        "labels": ["é”€å”®é¢", "è®¢å•æ•°", ...]
    }
    """
    pass

@router.get("/api/dashboard/sales/top-shops")
async def get_top_shops(
    start_date: str,
    end_date: str,
    top_n: int = 10,
    metric: str = "gmv",  # gmv/order_count
    db: Session = Depends(get_db)
):
    """
    è·å–Top Nåº—é“ºæ’å
    
    è¿”å›ï¼š
    {
        "shops": [
            {
                "shop_id": "shop001",
                "shop_name": "Shop 1",
                "gmv": 123456.78,
                "order_count": 123,
                "rank": 1
            },
            ...
        ]
    }
    """
    pass
```

---

## ğŸ‘¥ ç”¨æˆ·ç®¡ç†å’Œæƒé™ç³»ç»Ÿè®¾è®¡

### 1. è§’è‰²è®¾è®¡

#### 1.1 è§’è‰²å®šä¹‰

**å¼€å‘è€…ï¼ˆDeveloperï¼‰**
- æƒé™ï¼šæ‰€æœ‰åŠŸèƒ½ï¼ˆåŒ…æ‹¬å¼€å‘åŠŸèƒ½ï¼‰
- åŠŸèƒ½ï¼šå­—æ®µæ˜ å°„ã€æ•°æ®é‡‡é›†ã€ç³»ç»Ÿé…ç½®ã€å¼€å‘å·¥å…·
- ç‰¹ç‚¹ï¼šæœ€é«˜æƒé™ï¼Œç”¨äºå¼€å‘å’Œç»´æŠ¤

**ç®¡ç†å‘˜ï¼ˆAdminï¼‰**
- æƒé™ï¼šç³»ç»Ÿç®¡ç†å’Œä¸šåŠ¡ç®¡ç†
- åŠŸèƒ½ï¼šç”¨æˆ·ç®¡ç†ã€è´¦å·ç®¡ç†ã€æ•°æ®çœ‹æ¿ã€æŠ¥è¡¨å¯¼å‡º
- ç‰¹ç‚¹ï¼šç³»ç»Ÿç®¡ç†æƒé™ï¼Œè´Ÿè´£æ—¥å¸¸è¿è¥

**ä¸»ç®¡ï¼ˆSupervisorï¼‰**
- æƒé™ï¼šä¸šåŠ¡å®¡æ‰¹å’Œç›‘ç£
- åŠŸèƒ½ï¼šæ•°æ®çœ‹æ¿ã€å®¡æ‰¹æµç¨‹ã€æŠ¥è¡¨æŸ¥çœ‹ã€æ•°æ®åˆ†æ
- ç‰¹ç‚¹ï¼šä¸šåŠ¡å®¡æ‰¹æƒé™ï¼Œè´Ÿè´£å†³ç­–å’Œç›‘ç£

**æ“ä½œå‘˜ï¼ˆOperatorï¼‰**
- æƒé™ï¼šåŸºç¡€æ“ä½œæƒé™
- åŠŸèƒ½ï¼šæ•°æ®æŸ¥çœ‹ã€åŸºç¡€æ“ä½œã€æ•°æ®å½•å…¥
- ç‰¹ç‚¹ï¼šæ—¥å¸¸æ“ä½œæƒé™ï¼Œæ‰§è¡Œå…·ä½“ä¸šåŠ¡

#### 1.2 æƒé™çŸ©é˜µ

| åŠŸèƒ½æ¨¡å— | å¼€å‘è€… | ç®¡ç†å‘˜ | ä¸»ç®¡ | æ“ä½œå‘˜ |
|---------|--------|--------|------|--------|
| å­—æ®µæ˜ å°„ | âœ… | âŒ | âŒ | âŒ |
| æ•°æ®é‡‡é›† | âœ… | âœ… | âŒ | âŒ |
| æ•°æ®çœ‹æ¿ | âœ… | âœ… | âœ… | âœ…ï¼ˆåªè¯»ï¼‰ |
| è´¢åŠ¡ç®¡ç† | âœ… | âœ… | âœ… | âŒ |
| ç”¨æˆ·ç®¡ç† | âœ… | âœ… | âŒ | âŒ |
| è´¦å·ç®¡ç† | âœ… | âœ… | âœ…ï¼ˆå®¡æ‰¹ï¼‰ | âŒ |
| å®¡æ‰¹æµç¨‹ | âœ… | âœ… | âœ… | âŒ |
| æŠ¥è¡¨å¯¼å‡º | âœ… | âœ… | âœ… | âœ… |
| ç³»ç»Ÿé…ç½® | âœ… | âœ… | âŒ | âŒ |

### 2. æ•°æ®åº“è®¾è®¡

#### 2.1 ç”¨æˆ·è¡¨ï¼ˆUsersï¼‰

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    full_name VARCHAR(100),
    role VARCHAR(20) NOT NULL DEFAULT 'operator',  -- developer/admin/supervisor/operator
    status VARCHAR(20) NOT NULL DEFAULT 'pending',  -- pending/active/suspended/deleted
    department VARCHAR(50),
    phone VARCHAR(20),
    avatar_url VARCHAR(255),
    last_login_at TIMESTAMP,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    created_by INTEGER REFERENCES users(id),
    updated_by INTEGER REFERENCES users(id)
);

CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);
CREATE INDEX idx_users_status ON users(status);
```

#### 2.2 è§’è‰²è¡¨ï¼ˆRolesï¼‰

```sql
CREATE TABLE roles (
    id SERIAL PRIMARY KEY,
    role_code VARCHAR(20) UNIQUE NOT NULL,  -- developer/admin/supervisor/operator
    role_name VARCHAR(50) NOT NULL,
    description TEXT,
    permissions JSONB,  -- å­˜å‚¨æƒé™é…ç½®
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- åˆå§‹åŒ–è§’è‰²æ•°æ®
INSERT INTO roles (role_code, role_name, description, permissions) VALUES
('developer', 'å¼€å‘è€…', 'ç³»ç»Ÿå¼€å‘ç»´æŠ¤äººå‘˜', '{"all": true}'),
('admin', 'ç®¡ç†å‘˜', 'ç³»ç»Ÿç®¡ç†å‘˜', '{"dashboard": true, "user_management": true, "account_management": true}'),
('supervisor', 'ä¸»ç®¡', 'ä¸šåŠ¡ä¸»ç®¡', '{"dashboard": true, "approval": true, "report": true}'),
('operator', 'æ“ä½œå‘˜', 'åŸºç¡€æ“ä½œäººå‘˜', '{"dashboard": {"read": true}, "report": {"read": true}}');
```

#### 2.3 æƒé™è¡¨ï¼ˆPermissionsï¼‰

```sql
CREATE TABLE permissions (
    id SERIAL PRIMARY KEY,
    permission_code VARCHAR(50) UNIQUE NOT NULL,
    permission_name VARCHAR(100) NOT NULL,
    module VARCHAR(50) NOT NULL,  -- dashboard/field_mapping/data_collection/user_management
    action VARCHAR(50) NOT NULL,  -- create/read/update/delete/approve
    description TEXT,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- åˆå§‹åŒ–æƒé™æ•°æ®
INSERT INTO permissions (permission_code, permission_name, module, action, description) VALUES
('field_mapping:create', 'å­—æ®µæ˜ å°„-åˆ›å»º', 'field_mapping', 'create', 'åˆ›å»ºå­—æ®µæ˜ å°„'),
('field_mapping:read', 'å­—æ®µæ˜ å°„-æŸ¥çœ‹', 'field_mapping', 'read', 'æŸ¥çœ‹å­—æ®µæ˜ å°„'),
('field_mapping:update', 'å­—æ®µæ˜ å°„-æ›´æ–°', 'field_mapping', 'update', 'æ›´æ–°å­—æ®µæ˜ å°„'),
('field_mapping:delete', 'å­—æ®µæ˜ å°„-åˆ é™¤', 'field_mapping', 'delete', 'åˆ é™¤å­—æ®µæ˜ å°„'),
('dashboard:sales:read', 'é”€å”®çœ‹æ¿-æŸ¥çœ‹', 'dashboard', 'read', 'æŸ¥çœ‹é”€å”®çœ‹æ¿'),
('dashboard:finance:read', 'è´¢åŠ¡çœ‹æ¿-æŸ¥çœ‹', 'dashboard', 'read', 'æŸ¥çœ‹è´¢åŠ¡çœ‹æ¿'),
('user_management:create', 'ç”¨æˆ·ç®¡ç†-åˆ›å»º', 'user_management', 'create', 'åˆ›å»ºç”¨æˆ·'),
('user_management:approve', 'ç”¨æˆ·ç®¡ç†-å®¡æ‰¹', 'user_management', 'approve', 'å®¡æ‰¹ç”¨æˆ·æ³¨å†Œ'),
('account_management:create', 'è´¦å·ç®¡ç†-åˆ›å»º', 'account_management', 'create', 'åˆ›å»ºè´¦å·'),
('account_management:approve', 'è´¦å·ç®¡ç†-å®¡æ‰¹', 'account_management', 'approve', 'å®¡æ‰¹è´¦å·æ³¨å†Œ');
```

#### 2.4 è´¦å·æ³¨å†Œç”³è¯·è¡¨ï¼ˆAccountRegistrationï¼‰

```sql
CREATE TABLE account_registrations (
    id SERIAL PRIMARY KEY,
    applicant_id INTEGER NOT NULL REFERENCES users(id),
    platform VARCHAR(50) NOT NULL,  -- shopee/tiktok/amazon
    account_name VARCHAR(100) NOT NULL,
    shop_id VARCHAR(100),
    shop_name VARCHAR(200),
    login_url VARCHAR(500),
    account_type VARCHAR(50),  -- seller/buyer/supplier
    status VARCHAR(20) NOT NULL DEFAULT 'pending',  -- pending/approved/rejected
    current_step INTEGER NOT NULL DEFAULT 1,  -- å½“å‰å®¡æ‰¹æ­¥éª¤
    total_steps INTEGER NOT NULL DEFAULT 3,  -- æ€»å®¡æ‰¹æ­¥éª¤æ•°
    submitted_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    approved_at TIMESTAMP,
    rejected_at TIMESTAMP,
    rejection_reason TEXT,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_account_registrations_applicant ON account_registrations(applicant_id);
CREATE INDEX idx_account_registrations_status ON account_registrations(status);
CREATE INDEX idx_account_registrations_platform ON account_registrations(platform);
```

#### 2.5 å®¡æ‰¹æµç¨‹è¡¨ï¼ˆApprovalWorkflowï¼‰

```sql
CREATE TABLE approval_workflows (
    id SERIAL PRIMARY KEY,
    registration_id INTEGER NOT NULL REFERENCES account_registrations(id),
    step_number INTEGER NOT NULL,
    step_name VARCHAR(100) NOT NULL,
    approver_role VARCHAR(20) NOT NULL,  -- admin/supervisor
    approver_id INTEGER REFERENCES users(id),
    status VARCHAR(20) NOT NULL DEFAULT 'pending',  -- pending/approved/rejected
    comment TEXT,
    approved_at TIMESTAMP,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_approval_workflows_registration ON approval_workflows(registration_id);
CREATE INDEX idx_approval_workflows_status ON approval_workflows(status);
CREATE INDEX idx_approval_workflows_approver ON approval_workflows(approver_id);
```

### 3. ç”µå­å®¡æ‰¹æµç¨‹è®¾è®¡

#### 3.1 å®¡æ‰¹æµç¨‹å®šä¹‰

**è´¦å·æ³¨å†Œå®¡æ‰¹æµç¨‹**ï¼ˆ3æ­¥ï¼‰

```
æ­¥éª¤1: æäº¤ç”³è¯·
  â”œâ”€ ç”³è¯·äººï¼šæ“ä½œå‘˜/ç®¡ç†å‘˜
  â”œâ”€ æäº¤ä¿¡æ¯ï¼šå¹³å°ã€è´¦å·åã€åº—é“ºIDã€ç™»å½•URL
  â””â”€ çŠ¶æ€ï¼špending

æ­¥éª¤2: ä¸»ç®¡å®¡æ‰¹
  â”œâ”€ å®¡æ‰¹äººï¼šä¸»ç®¡ï¼ˆsupervisorï¼‰
  â”œâ”€ å®¡æ‰¹å†…å®¹ï¼šå®¡æ ¸è´¦å·ä¿¡æ¯ã€åº—é“ºä¿¡æ¯
  â”œâ”€ æ“ä½œï¼šæ‰¹å‡†/æ‹’ç»
  â””â”€ çŠ¶æ€ï¼šapproved/rejected

æ­¥éª¤3: ç®¡ç†å‘˜ç¡®è®¤
  â”œâ”€ å®¡æ‰¹äººï¼šç®¡ç†å‘˜ï¼ˆadminï¼‰
  â”œâ”€ å®¡æ‰¹å†…å®¹ï¼šæœ€ç»ˆç¡®è®¤ã€æ¿€æ´»è´¦å·
  â”œâ”€ æ“ä½œï¼šæ‰¹å‡†/æ‹’ç»
  â””â”€ çŠ¶æ€ï¼šapproved/rejected â†’ è´¦å·æ¿€æ´»
```

#### 3.2 ç”µå­æµç•Œé¢è®¾è®¡

**å®¡æ‰¹æµç¨‹å¯è§†åŒ–ç»„ä»¶** (`ApprovalFlow.vue`)

```vue
<template>
  <div class="approval-flow">
    <div class="flow-steps">
      <div 
        v-for="(step, index) in steps" 
        :key="index"
        :class="['step', getStepStatusClass(step)]"
      >
        <div class="step-icon">
          <el-icon v-if="step.status === 'approved'"><Check /></el-icon>
          <el-icon v-else-if="step.status === 'rejected'"><Close /></el-icon>
          <el-icon v-else><Clock /></el-icon>
        </div>
        <div class="step-content">
          <div class="step-title">{{ step.step_name }}</div>
          <div class="step-info">
            <span v-if="step.approver">å®¡æ‰¹äººï¼š{{ step.approver.name }}</span>
            <span v-if="step.approved_at">å®¡æ‰¹æ—¶é—´ï¼š{{ formatDate(step.approved_at) }}</span>
          </div>
          <div v-if="step.comment" class="step-comment">
            å®¡æ‰¹æ„è§ï¼š{{ step.comment }}
          </div>
        </div>
        <div class="step-connector" v-if="index < steps.length - 1"></div>
      </div>
    </div>
    
    <div class="flow-actions" v-if="canApprove">
      <el-button type="primary" @click="handleApprove">æ‰¹å‡†</el-button>
      <el-button type="danger" @click="handleReject">æ‹’ç»</el-button>
    </div>
  </div>
</template>
```

#### 3.3 å®¡æ‰¹APIè®¾è®¡

```python
# backend/routers/approval.py

@router.post("/api/approval/account-registration/submit")
async def submit_account_registration(
    registration: AccountRegistrationCreate,
    current_user: User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """
    æäº¤è´¦å·æ³¨å†Œç”³è¯·
    
    æƒé™ï¼šdeveloper/admin/operator
    """
    pass

@router.get("/api/approval/account-registration/list")
async def list_account_registrations(
    status: Optional[str] = None,
    current_user: User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """
    è·å–è´¦å·æ³¨å†Œç”³è¯·åˆ—è¡¨
    
    æƒé™ï¼š
    - developer/adminï¼šæŸ¥çœ‹æ‰€æœ‰ç”³è¯·
    - supervisorï¼šæŸ¥çœ‹å¾…å®¡æ‰¹çš„ç”³è¯·
    - operatorï¼šæŸ¥çœ‹è‡ªå·±æäº¤çš„ç”³è¯·
    """
    pass

@router.get("/api/approval/account-registration/{registration_id}/flow")
async def get_approval_flow(
    registration_id: int,
    current_user: User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """
    è·å–å®¡æ‰¹æµç¨‹è¯¦æƒ…ï¼ˆç”µå­æµå¯è§†åŒ–ï¼‰
    
    è¿”å›ï¼š
    {
        "registration_id": 1,
        "steps": [
            {
                "step_number": 1,
                "step_name": "æäº¤ç”³è¯·",
                "status": "approved",
                "approver": {"id": 1, "name": "å¼ ä¸‰"},
                "approved_at": "2025-11-01 10:00:00",
                "comment": "ç”³è¯·ä¿¡æ¯å®Œæ•´"
            },
            ...
        ],
        "current_step": 2,
        "can_approve": true
    }
    """
    pass

@router.post("/api/approval/account-registration/{registration_id}/approve")
async def approve_registration(
    registration_id: int,
    approval: ApprovalAction,
    current_user: User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """
    å®¡æ‰¹è´¦å·æ³¨å†Œç”³è¯·
    
    æƒé™ï¼šadmin/supervisorï¼ˆæ ¹æ®å½“å‰æ­¥éª¤ï¼‰
    
    è¯·æ±‚ä½“ï¼š
    {
        "action": "approve",  # approve/reject
        "comment": "å®¡æ‰¹æ„è§"
    }
    """
    pass
```

---

## ğŸš€ å®æ–½è®¡åˆ’

### Phase 1: ç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼ˆ1-2å‘¨ï¼‰
1. âœ… æ•°æ®åº“è¡¨è®¾è®¡ï¼ˆUsersã€Rolesã€Permissionsï¼‰
2. âœ… åç«¯APIå¼€å‘ï¼ˆç”¨æˆ·CRUDã€æƒé™éªŒè¯ï¼‰
3. âœ… å‰ç«¯ç•Œé¢å¼€å‘ï¼ˆç”¨æˆ·åˆ—è¡¨ã€è§’è‰²ç®¡ç†ï¼‰
4. âœ… æƒé™ä¸­é—´ä»¶å¼€å‘ï¼ˆJWT Tokenã€è§’è‰²éªŒè¯ï¼‰

### Phase 2: å®¡æ‰¹æµç¨‹ç³»ç»Ÿï¼ˆ1-2å‘¨ï¼‰
1. âœ… æ•°æ®åº“è¡¨è®¾è®¡ï¼ˆAccountRegistrationã€ApprovalWorkflowï¼‰
2. âœ… åç«¯APIå¼€å‘ï¼ˆå®¡æ‰¹æµç¨‹ã€ç”µå­æµAPIï¼‰
3. âœ… å‰ç«¯ç•Œé¢å¼€å‘ï¼ˆå®¡æ‰¹æµç¨‹å¯è§†åŒ–ã€å®¡æ‰¹æ“ä½œï¼‰

### Phase 3: æ•°æ®çœ‹æ¿ç³»ç»Ÿï¼ˆ2-3å‘¨ï¼‰
1. âœ… åç«¯APIå¼€å‘ï¼ˆçœ‹æ¿æ•°æ®APIï¼‰
2. âœ… å‰ç«¯ç»„ä»¶å¼€å‘ï¼ˆKPIå¡ç‰‡ã€å›¾è¡¨ç»„ä»¶ï¼‰
3. âœ… çœ‹æ¿é¡µé¢å¼€å‘ï¼ˆé”€å”®ã€åº“å­˜ã€è´¢åŠ¡ç­‰ï¼‰
4. âœ… å®æ—¶æ•°æ®åŒæ­¥ï¼ˆWebSocketï¼‰

### Phase 4: æµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰
1. âœ… å•å…ƒæµ‹è¯•
2. âœ… é›†æˆæµ‹è¯•
3. âœ… æ€§èƒ½ä¼˜åŒ–
4. âœ… ç”¨æˆ·éªŒæ”¶æµ‹è¯•

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ä¼ä¸šçº§ERPå¼€å‘æ ‡å‡†](.cursorrules)
- [APIè®¾è®¡è§„èŒƒ](docs/DEVELOPMENT_RULES/API_DESIGN.md)
- [å®‰å…¨è§„èŒƒ](docs/DEVELOPMENT_RULES/SECURITY.md)
- [æ•°æ®åº“è®¾è®¡è§„èŒƒ](docs/DEVELOPMENT_RULES/DATABASE_DESIGN.md)

---

**è§„åˆ’å®Œæˆæ—¶é—´**: 2025-11-01  
**é¢„è®¡å¼€å§‹æ—¶é—´**: 2025-11-02  
**é¢„è®¡å®Œæˆæ—¶é—´**: 2025-11-30

