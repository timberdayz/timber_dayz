# Dockeréƒ¨ç½²éªŒè¯æ¸…å•

> **å¿«é€ŸéªŒè¯Dockeréƒ¨ç½²æ˜¯å¦æˆåŠŸ**  
> v4.0.0 - 2025-10-23

---

## ğŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

### âœ… ç¯å¢ƒå‡†å¤‡

- [ ] Dockerå·²å®‰è£…å¹¶è¿è¡Œ
  ```bash
  docker --version  # åº”æ˜¾ç¤ºç‰ˆæœ¬å·
  docker info       # åº”æ˜¾ç¤ºDockerä¿¡æ¯
  ```

- [ ] Docker Composeå·²å®‰è£…
  ```bash
  docker-compose --version  # åº”æ˜¾ç¤ºç‰ˆæœ¬å·
  ```

- [ ] ç£ç›˜ç©ºé—´å……è¶³
  ```bash
  df -h  # Linux/Mac
  # Windows: æŸ¥çœ‹Cç›˜ç©ºé—´
  # è‡³å°‘éœ€è¦10GBå¯ç”¨ç©ºé—´
  ```

- [ ] å†…å­˜å……è¶³
  ```bash
  free -h  # Linux
  # è‡³å°‘éœ€è¦4GBå¯ç”¨å†…å­˜
  ```

### âœ… é…ç½®æ–‡ä»¶

- [ ] ç¯å¢ƒå˜é‡æ–‡ä»¶å·²åˆ›å»º
  ```bash
  ls -la .env  # åº”å­˜åœ¨.envæ–‡ä»¶
  ```

- [ ] æ•°æ®åº“å¯†ç å·²ä¿®æ”¹ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
  ```bash
  grep POSTGRES_PASSWORD .env
  # ä¸åº”è¯¥æ˜¯é»˜è®¤å¯†ç 
  ```

- [ ] APIå¯†é’¥å·²ä¿®æ”¹ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
  ```bash
  grep SECRET_KEY .env
  # ä¸åº”è¯¥æ˜¯é»˜è®¤å€¼
  ```

- [ ] ç«¯å£é…ç½®æ­£ç¡®
  ```bash
  grep _PORT .env
  # ç¡®è®¤ç«¯å£æœªè¢«å ç”¨
  ```

### âœ… æ–‡ä»¶æƒé™

- [ ] å¯åŠ¨è„šæœ¬æœ‰æ‰§è¡Œæƒé™ï¼ˆLinux/Macï¼‰
  ```bash
  ls -l docker/scripts/*.sh
  # åº”æ˜¾ç¤º -rwxr-xr-x
  chmod +x docker/scripts/*.sh  # å¦‚éœ€æ·»åŠ æƒé™
  ```

---

## ğŸš€ éƒ¨ç½²åéªŒè¯æ¸…å•

### âœ… å®¹å™¨çŠ¶æ€

- [ ] æ‰€æœ‰å®¹å™¨æ­£å¸¸è¿è¡Œ
  ```bash
  docker-compose ps
  # æ‰€æœ‰æœåŠ¡åº”æ˜¾ç¤º "Up" çŠ¶æ€
  ```

- [ ] PostgreSQLå®¹å™¨å¥åº·
  ```bash
  docker-compose exec postgres pg_isready -U erp_user -d xihong_erp
  # åº”æ˜¾ç¤º: "accepting connections"
  ```

- [ ] åç«¯å®¹å™¨å¥åº·ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰
  ```bash
  curl -f http://localhost:8001/health
  # åº”è¿”å›: {"status":"healthy"}
  ```

- [ ] å‰ç«¯å®¹å™¨å¥åº·ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰
  ```bash
  curl -f http://localhost:5174
  # åº”è¿”å›HTMLå†…å®¹
  ```

### âœ… æœåŠ¡è®¿é—®

- [ ] æ•°æ®åº“å¯è®¿é—®
  ```bash
  # ä½¿ç”¨psqlæˆ–pgAdminè¿æ¥
  psql -h localhost -p 5432 -U erp_user -d xihong_erp
  # åº”èƒ½æˆåŠŸç™»å½•
  ```

- [ ] pgAdminå¯è®¿é—®ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
  ```bash
  # æµè§ˆå™¨è®¿é—®: http://localhost:5051
  # åº”æ˜¾ç¤ºç™»å½•é¡µé¢
  ```

- [ ] åç«¯APIå¯è®¿é—®
  ```bash
  # æµè§ˆå™¨è®¿é—®APIæ–‡æ¡£
  # http://localhost:8001/api/docs
  # åº”æ˜¾ç¤ºSwagger UI
  ```

- [ ] å‰ç«¯ç•Œé¢å¯è®¿é—®
  ```bash
  # æµè§ˆå™¨è®¿é—®
  # http://localhost:5174 (ç”Ÿäº§)
  # http://localhost:5173 (å¼€å‘)
  # åº”æ˜¾ç¤ºç™»å½•é¡µé¢
  ```

### âœ… æ•°æ®åº“éªŒè¯

- [ ] æ•°æ®åº“å·²åˆ›å»º
  ```sql
  -- è¿æ¥æ•°æ®åº“åæ‰§è¡Œ
  \l  -- åº”åˆ—å‡ºxihong_erpæ•°æ®åº“
  ```

- [ ] è¡¨å·²åˆ›å»º
  ```sql
  \dt  -- åº”æ˜¾ç¤ºæ‰€æœ‰è¡¨
  # è‡³å°‘åŒ…å«: accounts, data_files, field_mappingsç­‰
  ```

- [ ] ç¤ºä¾‹æ•°æ®å·²æ’å…¥
  ```sql
  SELECT COUNT(*) FROM accounts;
  # åº”è¿”å›è‡³å°‘4æ¡è®°å½•
  ```

- [ ] ç´¢å¼•å·²åˆ›å»º
  ```sql
  \di  -- åº”æ˜¾ç¤ºæ‰€æœ‰ç´¢å¼•
  ```

### âœ… ç½‘ç»œè¿é€šæ€§

- [ ] å‰ç«¯å¯è®¿é—®åç«¯
  ```bash
  # åœ¨å‰ç«¯å®¹å™¨å†…æµ‹è¯•
  docker-compose exec frontend wget -qO- http://backend:8000/health
  # åº”è¿”å›å¥åº·ä¿¡æ¯
  ```

- [ ] åç«¯å¯è®¿é—®æ•°æ®åº“
  ```bash
  # åœ¨åç«¯å®¹å™¨å†…æµ‹è¯•
  docker-compose exec backend python -c "from backend.models.database import engine; engine.connect()"
  # åº”æ— é”™è¯¯è¾“å‡º
  ```

### âœ… æ—¥å¿—æ£€æŸ¥

- [ ] PostgreSQLæ—¥å¿—æ­£å¸¸
  ```bash
  docker-compose logs postgres | grep -i error
  # åº”æ— å…³é”®é”™è¯¯
  ```

- [ ] åç«¯æ—¥å¿—æ­£å¸¸ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰
  ```bash
  docker-compose logs backend | grep -i error
  # åº”æ— å…³é”®é”™è¯¯
  ```

- [ ] å‰ç«¯æ—¥å¿—æ­£å¸¸ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰
  ```bash
  docker-compose logs frontend | grep -i error
  # åº”æ— å…³é”®é”™è¯¯
  ```

### âœ… æ€§èƒ½æ£€æŸ¥

- [ ] å®¹å™¨èµ„æºä½¿ç”¨æ­£å¸¸
  ```bash
  docker stats --no-stream
  # CPUå’Œå†…å­˜ä½¿ç”¨ç‡åº”åœ¨åˆç†èŒƒå›´
  ```

- [ ] APIå“åº”æ—¶é—´æ­£å¸¸
  ```bash
  curl -w "å“åº”æ—¶é—´: %{time_total}ç§’\n" -o /dev/null -s http://localhost:8001/health
  # åº”<2ç§’
  ```

### âœ… æ•°æ®æŒä¹…åŒ–

- [ ] PostgreSQLæ•°æ®å·å·²åˆ›å»º
  ```bash
  docker volume ls | grep postgres_data
  # åº”æ˜¾ç¤º xihong_erp_postgres_data
  ```

- [ ] æ•°æ®ç›®å½•å·²æŒ‚è½½
  ```bash
  ls -la data/
  # åº”æ˜¾ç¤ºæ•°æ®æ–‡ä»¶
  ```

- [ ] æ—¥å¿—ç›®å½•å·²æŒ‚è½½
  ```bash
  ls -la logs/
  # åº”æ˜¾ç¤ºæ—¥å¿—æ–‡ä»¶
  ```

---

## ğŸ”§ åŠŸèƒ½æµ‹è¯•æ¸…å•

### âœ… åŸºç¡€åŠŸèƒ½

- [ ] ç”¨æˆ·å¯ä»¥ç™»å½•ç³»ç»Ÿ
- [ ] å¯ä»¥æŸ¥çœ‹æ•°æ®çœ‹æ¿
- [ ] å¯ä»¥è®¿é—®æ•°æ®ç®¡ç†é¡µé¢
- [ ] å¯ä»¥è®¿é—®è´¦å·ç®¡ç†é¡µé¢
- [ ] å¯ä»¥è®¿é—®å­—æ®µæ˜ å°„é¡µé¢

### âœ… APIæµ‹è¯•

- [ ] å¥åº·æ£€æŸ¥ç«¯ç‚¹
  ```bash
  curl http://localhost:8001/health
  ```

- [ ] APIæ–‡æ¡£å¯è®¿é—®
  ```bash
  curl http://localhost:8001/api/docs
  ```

- [ ] æ•°æ®æŸ¥è¯¢API
  ```bash
  curl http://localhost:8001/api/dashboard/stats
  ```

### âœ… æ•°æ®æ“ä½œ

- [ ] å¯ä»¥åˆ›å»ºæ•°æ®è®°å½•
- [ ] å¯ä»¥è¯»å–æ•°æ®è®°å½•
- [ ] å¯ä»¥æ›´æ–°æ•°æ®è®°å½•
- [ ] å¯ä»¥åˆ é™¤æ•°æ®è®°å½•

---

## ğŸ› ï¸ æ•…éšœè¯Šæ–­æ¸…å•

### âŒ å®¹å™¨æ— æ³•å¯åŠ¨

- [ ] æ£€æŸ¥DockeræœåŠ¡
  ```bash
  docker info
  ```

- [ ] æ£€æŸ¥ç«¯å£å ç”¨
  ```bash
  # Windows
  netstat -ano | findstr :5432
  # Linux/Mac
  lsof -i:5432
  ```

- [ ] æŸ¥çœ‹å®¹å™¨æ—¥å¿—
  ```bash
  docker-compose logs <service-name>
  ```

### âŒ æ•°æ®åº“è¿æ¥å¤±è´¥

- [ ] æ£€æŸ¥æ•°æ®åº“å®¹å™¨çŠ¶æ€
  ```bash
  docker-compose ps postgres
  ```

- [ ] æ£€æŸ¥æ•°æ®åº“é…ç½®
  ```bash
  grep DATABASE_URL .env
  ```

- [ ] æµ‹è¯•æ•°æ®åº“è¿æ¥
  ```bash
  docker-compose exec postgres pg_isready
  ```

### âŒ å‰ç«¯è®¿é—®å¤±è´¥

- [ ] æ£€æŸ¥å‰ç«¯å®¹å™¨çŠ¶æ€
  ```bash
  docker-compose ps frontend
  ```

- [ ] æ£€æŸ¥å‰ç«¯æ—¥å¿—
  ```bash
  docker-compose logs frontend
  ```

- [ ] æ£€æŸ¥Nginxé…ç½®
  ```bash
  docker-compose exec frontend nginx -t
  ```

### âŒ åç«¯APIå¤±è´¥

- [ ] æ£€æŸ¥åç«¯å®¹å™¨çŠ¶æ€
  ```bash
  docker-compose ps backend
  ```

- [ ] æ£€æŸ¥åç«¯æ—¥å¿—
  ```bash
  docker-compose logs backend
  ```

- [ ] æµ‹è¯•å¥åº·ç«¯ç‚¹
  ```bash
  curl http://localhost:8001/health
  ```

---

## ğŸ“Š æ€§èƒ½åŸºå‡†

### âœ… å“åº”æ—¶é—´

- [ ] å‰ç«¯é¦–é¡µåŠ è½½ < 2ç§’
- [ ] APIå¥åº·æ£€æŸ¥ < 500ms
- [ ] æ•°æ®æŸ¥è¯¢API < 1ç§’
- [ ] æ•°æ®åº“æŸ¥è¯¢ < 500ms

### âœ… èµ„æºä½¿ç”¨

- [ ] PostgreSQLå†…å­˜ < 1GB
- [ ] åç«¯å†…å­˜ < 512MB
- [ ] å‰ç«¯å†…å­˜ < 256MB
- [ ] æ€»CPUä½¿ç”¨ < 50%

### âœ… å¹¶å‘èƒ½åŠ›

- [ ] æ”¯æŒ10ä¸ªå¹¶å‘ç”¨æˆ·
- [ ] æ”¯æŒ100ä¸ªå¹¶å‘è¯·æ±‚
- [ ] æ•°æ®åº“è¿æ¥æ± æ­£å¸¸

---

## ğŸ”’ å®‰å…¨æ£€æŸ¥æ¸…å•

### âœ… å¯†ç å®‰å…¨

- [ ] æ•°æ®åº“å¯†ç å·²ä¿®æ”¹
- [ ] APIå¯†é’¥å·²ä¿®æ”¹
- [ ] pgAdminå¯†ç å·²ä¿®æ”¹
- [ ] å¯†ç å¼ºåº¦è¶³å¤Ÿï¼ˆè‡³å°‘12ä½ï¼‰

### âœ… ç½‘ç»œå®‰å…¨

- [ ] ç”Ÿäº§ç¯å¢ƒç¦ç”¨pgAdmin
- [ ] CORSé…ç½®æ­£ç¡®
- [ ] ä»…å¿…è¦ç«¯å£å¯¹å¤–å¼€æ”¾
- [ ] ä½¿ç”¨HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

### âœ… æ•°æ®å®‰å…¨

- [ ] æ•°æ®å®šæœŸå¤‡ä»½
- [ ] å¤‡ä»½å¯æ­£å¸¸æ¢å¤
- [ ] æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- [ ] æ—¥å¿—ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯

---

## ğŸ“ éªŒè¯æŠ¥å‘Šæ¨¡æ¿

```
# Dockeréƒ¨ç½²éªŒè¯æŠ¥å‘Š

**éƒ¨ç½²æ—¥æœŸ**: YYYY-MM-DD
**éƒ¨ç½²ç¯å¢ƒ**: å¼€å‘/ç”Ÿäº§
**éƒ¨ç½²äºº**: å§“å

## éƒ¨ç½²å‰æ£€æŸ¥
- [x] ç¯å¢ƒå‡†å¤‡: âœ… é€šè¿‡
- [x] é…ç½®æ–‡ä»¶: âœ… é€šè¿‡
- [x] æ–‡ä»¶æƒé™: âœ… é€šè¿‡

## éƒ¨ç½²åéªŒè¯
- [x] å®¹å™¨çŠ¶æ€: âœ… æ‰€æœ‰å®¹å™¨è¿è¡Œæ­£å¸¸
- [x] æœåŠ¡è®¿é—®: âœ… æ‰€æœ‰æœåŠ¡å¯è®¿é—®
- [x] æ•°æ®åº“éªŒè¯: âœ… æ•°æ®åº“æ­£å¸¸
- [x] ç½‘ç»œè¿é€šæ€§: âœ… ç½‘ç»œæ­£å¸¸
- [x] æ—¥å¿—æ£€æŸ¥: âœ… æ— é”™è¯¯
- [x] æ€§èƒ½æ£€æŸ¥: âœ… æ€§èƒ½æ­£å¸¸
- [x] æ•°æ®æŒä¹…åŒ–: âœ… æ•°æ®æŒä¹…åŒ–æ­£å¸¸

## åŠŸèƒ½æµ‹è¯•
- [x] åŸºç¡€åŠŸèƒ½: âœ… é€šè¿‡
- [x] APIæµ‹è¯•: âœ… é€šè¿‡
- [x] æ•°æ®æ“ä½œ: âœ… é€šè¿‡

## æ€§èƒ½åŸºå‡†
- å‰ç«¯é¦–é¡µåŠ è½½: 1.2ç§’ âœ…
- APIå“åº”æ—¶é—´: 300ms âœ…
- PostgreSQLå†…å­˜: 512MB âœ…

## å®‰å…¨æ£€æŸ¥
- [x] å¯†ç å®‰å…¨: âœ… é€šè¿‡
- [x] ç½‘ç»œå®‰å…¨: âœ… é€šè¿‡
- [x] æ•°æ®å®‰å…¨: âœ… é€šè¿‡

## é—®é¢˜è®°å½•
æ— 

## éªŒè¯ç»“è®º
âœ… éƒ¨ç½²æˆåŠŸï¼Œç³»ç»Ÿè¿è¡Œæ­£å¸¸

**éªŒè¯äºº**: ___________
**æ—¥æœŸ**: ___________
```

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœéªŒè¯è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ—¥å¿—**: `docker-compose logs -f`
2. **å¥åº·æ£€æŸ¥**: `make health` æˆ– `./docker/scripts/health-check.sh`
3. **æŸ¥é˜…æ–‡æ¡£**: `docs/DOCKER_DEPLOYMENT.md`
4. **é‡æ–°éƒ¨ç½²**: å…ˆ`docker-compose down`ï¼Œå†é‡æ–°å¯åŠ¨

---

**æœ€åæ›´æ–°**: 2025-10-23  
**ç»´æŠ¤è€…**: è¥¿è™¹ERPå›¢é˜Ÿ

