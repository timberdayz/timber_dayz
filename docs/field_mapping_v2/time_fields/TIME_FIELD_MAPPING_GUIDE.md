# 时间字段映射指南

## 时间字段映射规则

根据不同的时间格式，选择对应的标准字段：

### 1. 年月格式：`2025\08`
- **应该选择**：**日期** (`metric_date`)
- **说明**：只有年月，没有具体日期，系统会自动转换为 `2025-08-01`（月初第一天）
- **字段代码**：`metric_date`
- **数据类型**：`date`
- **用户操作**：在下拉菜单中选择"日期"

### 2. 完整日期格式：`2025\08\25` 或 `2025-08-25`
- **应该选择**：**日期** (`metric_date`)
- **说明**：只有日期，没有时间，系统会自动丢弃时间部分
- **字段代码**：`metric_date`
- **数据类型**：`date`
- **用户操作**：在下拉菜单中选择"日期"

### 3. 日期时间格式：`2025-08-25-15：01` 或 `2025-08-25 15:01`
- **应该选择**：**日期时间** (`datetime`)
- **说明**：包含日期和时间，系统会保留完整的时间信息
- **字段代码**：`datetime`
- **数据类型**：`datetime`
- **用户操作**：在下拉菜单中选择"日期时间"
- **注意**：如果这是特定业务场景的时间（如下单时间、付款时间），可以选择对应的业务字段

### 4. 时间范围格式：`2025-08-25-15：01 ~ 2025-08-29-12：01` 或 `2025-08-18-15:01~2025-08-25-15:01`
- **系统自动处理**：系统会自动识别时间范围格式，拆分为两个字段：
  - **开始时间** (`start_time`)：`2025-08-25 15:01` 或 `2025-08-18 15:01`
  - **结束时间** (`end_time`)：`2025-08-29 12:01` 或 `2025-08-25 15:01`
- **用户操作**：**无需手动选择**，系统会自动拆分并映射
- **说明**：系统会显示提示信息"检测到时间范围字段，已自动拆分为开始时间和结束时间"
- **支持的格式**：
  - `2025-08-25 17:01~2025-08-26 11:02`（空格分隔）
  - `2025-08-18-15:01~2025-08-25-15:01`（Shopee服务数据域周数据格式）
  - `2025-08-25~2025-08-26`（仅日期范围）
  - `25/08/2025 - 26/08/2025`（斜杠格式）

## 当前通用字段列表

### 通用日期字段
- **字段名称**：日期
- **字段代码**：`metric_date`
- **数据类型**：`date`
- **数据域**：`analytics`（但可用于所有数据域）
- **说明**：通用的日期字段，丢弃时间部分

### 通用日期时间字段（新增）
- **字段名称**：日期时间
- **字段代码**：`datetime`
- **数据类型**：`datetime`
- **数据域**：`general`
- **说明**：通用的日期时间字段，保留时间部分

### 通用时间范围字段
- **开始时间** (`start_time`)：datetime类型，general域
- **结束时间** (`end_time`)：datetime类型，general域

## 映射示例

| 原始数据格式 | 选择字段 | 字段代码 | 说明 |
|:---|:---|:---|:---|
| `2025\08` | 日期 | `metric_date` | 年月格式，转换为月初 |
| `2025\08\25` | 日期 | `metric_date` | 完整日期，丢弃时间 |
| `2025-08-25` | 日期 | `metric_date` | 完整日期，丢弃时间 |
| `2025-08-25-15：01` | 日期时间 | `datetime` | 日期时间，保留时间 |
| `2025-08-25 15:01` | 日期时间 | `datetime` | 日期时间，保留时间 |
| `2025-08-25-15：01 ~ 2025-08-29-12：01` | **自动拆分** | `start_time` + `end_time` | 时间范围，自动拆分 |
| `2025-08-18-15:01~2025-08-25-15:01` | **自动拆分** | `start_time` + `end_time` | Shopee周数据格式，自动拆分 |

## 业务特定字段（可选）

如果时间字段有特定的业务含义，可以选择对应的业务字段：

- **下单时间** (`order_time_utc`) - 订单域
- **付款时间** (`payment_time`) - 订单域
- **发货时间** (`ship_time`) - 订单域
- **创建时间** (`created_at`) - 通用
- **更新时间** (`updated_at`) - 通用

**建议**：如果没有特定业务含义，使用通用的"日期时间"字段即可。

## 常见问题

### Q: Shopee服务数据域的周数据时间格式 `2025-08-18-15:01~2025-08-25-15:01` 应该选择什么？

**A: 无需手动选择，系统会自动处理！**

当您点击"智能映射"按钮时，系统会：
1. ✅ 自动检测到这是时间范围格式
2. ✅ 自动拆分为两个字段：
   - **开始时间** (`start_time`)：`2025-08-18 15:01`
   - **结束时间** (`end_time`)：`2025-08-25 15:01`
3. ✅ 在映射表中显示两个独立的映射项
4. ✅ 显示提示信息："检测到时间范围字段"XX"，已自动拆分为开始时间和结束时间"

**您只需要确认映射结果即可，无需手动选择任何选项，也无需空着不选。**

### Q: 如果系统没有自动识别时间范围怎么办？

如果系统没有自动识别，您可以：
1. 点击"重新预览"按钮，确保系统获取到了正确的样本数据
2. 检查原始数据格式是否正确（包含`~`分隔符）
3. 极少情况下，可以手动选择"开始时间"和"结束时间"两个字段

### Q: 时间范围字段会如何存储？

系统会将时间范围拆分为两个独立的datetime字段：
- `start_time`：开始时间（datetime类型）
- `end_time`：结束时间（datetime类型）

这样设计的好处：
- ✅ 便于查询（可以使用SQL范围查询）
- ✅ 便于索引（两个字段都可以单独建索引）
- ✅ 符合数据库规范化设计


