# =====================================================
# 西虹ERP系统 - 生产环境配置（腾讯云2核4G优化）
# =====================================================
# 用于腾讯云2核4G服务器部署
# 使用方式: cp env.production.cloud.example .env
# ⚠️ 重要: 必须修改所有密码和密钥！
# =====================================================

# ==================== 环境标识（必须） ====================
ENVIRONMENT=production
APP_ENV=production
DEBUG=false

# ==================== 数据库配置（必须修改密码） ====================
# Docker容器内使用服务名 'postgres'
DATABASE_URL=postgresql://erp_user:YOUR_SECURE_PASSWORD_HERE@postgres:5432/xihong_erp
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=erp_user
POSTGRES_PASSWORD=YOUR_SECURE_PASSWORD_HERE
POSTGRES_DB=xihong_erp

# ==================== 安全配置（必须修改） ====================
# 生成命令: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=YOUR_SECRET_KEY_CHANGE_THIS_TO_RANDOM_STRING_AT_LEAST_32_CHARACTERS
JWT_SECRET_KEY=YOUR_JWT_SECRET_KEY_CHANGE_THIS_TO_RANDOM_STRING_AT_LEAST_32_CHARACTERS

# 生成命令: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ACCOUNT_ENCRYPTION_KEY=

# ==================== 服务器配置（根据实际情况修改） ====================
# 允许外部访问
HOST=0.0.0.0
PORT=8000
FRONTEND_PORT=80

# ⚠️ 必须修改为实际服务器IP或域名
# 示例: ALLOWED_ORIGINS=http://123.456.789.0,https://your-domain.com
ALLOWED_ORIGINS=http://YOUR_SERVER_IP,https://your-domain.com
ALLOWED_HOSTS=YOUR_SERVER_IP,your-domain.com

# ==================== Redis配置（必须修改密码） ====================
REDIS_URL=redis://:YOUR_REDIS_PASSWORD_HERE@redis:6379/0
REDIS_PASSWORD=YOUR_REDIS_PASSWORD_HERE
CELERY_BROKER_URL=redis://:YOUR_REDIS_PASSWORD_HERE@redis:6379/0
CELERY_RESULT_BACKEND=redis://:YOUR_REDIS_PASSWORD_HERE@redis:6379/0

# ==================== 前端配置（根据实际情况修改） ====================
# ⚠️ 重要：前端构建时使用 VITE_API_BASE_URL（不是 VITE_API_URL）
# 如果使用Nginx反向代理（推荐），使用相对路径: /api
# 如果直接访问后端，使用完整URL: http://YOUR_SERVER_IP:8000
VITE_API_BASE_URL=/api
VITE_MODE=production

# ==================== 性能优化（2核4G服务器） ====================
# 连接池大小（从默认30降到10）
DB_POOL_SIZE=10
# 连接池最大溢出（从默认60降到20）
DB_MAX_OVERFLOW=20
# 连接超时
DB_POOL_TIMEOUT=30
# 连接回收时间
DB_POOL_RECYCLE=1800

# 最大并发采集任务数（从默认5降到2）
MAX_CONCURRENT_TASKS=2

# ==================== Playwright配置 ====================
PLAYWRIGHT_HEADLESS=true
PLAYWRIGHT_SLOW_MO=0
PLAYWRIGHT_TIMEOUT=30000

# ==================== 日志配置 ====================
LOG_LEVEL=INFO
DATABASE_ECHO=false

# ==================== JWT Token配置 ====================
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7
JWT_ALGORITHM=HS256

# ==================== 数据保留 ====================
DATA_RETENTION_DAYS=90

# ==================== 其他配置 ====================
# 是否启用Redis（生产环境建议启用）
REDIS_ENABLED=true

# 文件存储目录（Docker容器内路径）
PROJECT_ROOT=/app
DATA_DIR=/app/data
DATA_RAW_DIR=/app/data/raw
DOWNLOADS_DIR=/app/downloads
TEMP_DIR=/app/temp
LOGS_DIR=/app/logs

# Python和Node版本（Docker构建使用）
PYTHON_VERSION=3.11
NODE_VERSION=18
