"""
éªŒè¯è„šæœ¬ï¼šæ£€æŸ¥ä»£ç ä¸­æ˜¯å¦å­˜åœ¨ emoji å­—ç¬¦

Windows æ§åˆ¶å°é»˜è®¤ä½¿ç”¨ GBK ç¼–ç ï¼Œæ— æ³•æ­£ç¡®æ˜¾ç¤º emoji å­—ç¬¦ï¼Œ
ä¼šå¯¼è‡´ UnicodeEncodeError å¼‚å¸¸ã€‚æ­¤è„šæœ¬ç”¨äºæ£€æµ‹å¹¶æŠ¥å‘Šéœ€è¦ä¿®å¤çš„æ–‡ä»¶ã€‚

ä½¿ç”¨æ–¹æ³•:
    python scripts/verify_no_emoji.py [--fix]
    
    --fix: è‡ªåŠ¨æ›¿æ¢æ£€æµ‹åˆ°çš„ emoji ä¸º ASCII ç¬¦å·
"""

import re
import sys
from pathlib import Path


# Emoji åˆ° ASCII çš„æ›¿æ¢æ˜ å°„
EMOJI_REPLACEMENTS = {
    # çŠ¶æ€ç¬¦å·
    'âœ…': '[OK]',
    'âŒ': '[FAIL]',
    'âš ï¸': '[WARN]',
    'âš ': '[WARN]',
    'âœ“': '[OK]',
    'âœ—': '[FAIL]',
    'âœ”': '[OK]',
    'âœ˜': '[FAIL]',
    
    # ç®­å¤´ç¬¦å·
    'â†ª': '->',
    'â†’': '->',
    'â†': '<-',
    'â†‘': '^',
    'â†“': 'v',
    'âœ': '->',
    'â¤': '->',
    'â”': '->',
    'â‡’': '=>',
    'â‡': '<=',
    'ğŸ‘‰': '->',
    'ğŸ‘ˆ': '<-',
    'â¬†ï¸': '[UP]',
    'â¬‡ï¸': '[DOWN]',
    'â¡ï¸': '[RIGHT]',
    'â¬…ï¸': '[LEFT]',
    
    # æ“ä½œç¬¦å·
    'â–¶': '[START]',
    'â©': '[FAST]',
    'ğŸš€': '[START]',
    'ğŸ‰': '[DONE]',
    'ğŸ”„': '[RETRY]',
    'â±ï¸': '[TIME]',
    'â±': '[TIME]',
    'â³': '[WAIT]',
    'â°': '[TIME]',
    'â¹ï¸': '[STOP]',
    'â¹': '[STOP]',
    'â¸ï¸': '[PAUSE]',
    'â¸': '[PAUSE]',
    
    # æœç´¢å’ŒæŸ¥çœ‹
    'ğŸ”': '[SEARCH]',
    'ğŸ”': '[SEARCH]',
    'ğŸ‘€': '[LOOK]',
    'ğŸ‘': '[VIEW]',
    
    # æ–‡ä»¶å’Œæ–‡ä»¶å¤¹
    'ğŸ“': '[DIR]',
    'ğŸ“‚': '[FOLDER]',
    'ğŸ“„': '[FILE]',
    'ğŸ“ƒ': '[DOC]',
    'ğŸ—‚ï¸': '[FILES]',
    'ğŸ—‚': '[FILES]',
    'ğŸ—ƒï¸': '[ARCHIVE]',
    'ğŸ—ƒ': '[ARCHIVE]',
    'ğŸ“¦': '[PKG]',
    
    # æ•°æ®å’Œå›¾è¡¨
    'ğŸ“Š': '[DATA]',
    'ğŸ“ˆ': '[CHART]',
    'ğŸ“‰': '[CHART]',
    'ğŸ“‹': '[LIST]',
    'ğŸ“…': '[DATE]',
    'ğŸ“†': '[CAL]',
    
    # å·¥å…·å’Œè®¾ç½®
    'ğŸ”§': '[TOOL]',
    'ğŸ”¨': '[TOOL]',
    'âš™ï¸': '[GEAR]',
    'âš™': '[GEAR]',
    'ğŸ› ï¸': '[TOOLS]',
    'ğŸ› ': '[TOOLS]',
    'ğŸ§°': '[TOOLKIT]',
    
    # å®‰å…¨å’Œé”å®š
    'ğŸ”’': '[LOCK]',
    'ğŸ”“': '[UNLOCK]',
    'ğŸ”': '[SECURE]',
    'ğŸ”‘': '[KEY]',
    'ğŸ›¡ï¸': '[SHIELD]',
    'ğŸ›¡': '[SHIELD]',
    'ğŸ”': '[PRIVATE]',
    'ğŸ”‘': '[KEY]',
    'ğŸ”': '[LOCK]',
    
    # é€šçŸ¥å’Œæ¶ˆæ¯
    'ğŸ“': '[NOTE]',
    'ğŸ’¡': '[TIP]',
    'ğŸ“Œ': '[PIN]',
    'ğŸ””': '[BELL]',
    'ğŸ“£': '[ANNOUNCE]',
    'ğŸ’¬': '[MSG]',
    'ğŸ“§': '[EMAIL]',
    'ğŸ“©': '[MAIL]',
    'ğŸ“¨': '[INBOX]',
    'ğŸ“®': '[POST]',
    'ğŸ“ª': '[MAILBOX]',
    'ğŸ“«': '[MAILBOX]',
    'ğŸ“¬': '[MAILBOX]',
    'ğŸ“­': '[MAILBOX]',
    'âœ‰ï¸': '[EMAIL]',
    'âœ‰': '[EMAIL]',
    'ğŸ“¤': '[SEND]',
    'ğŸ“¥': '[RECV]',
    'ğŸ“¡': '[SIGNAL]',
    
    # å•†ä¸šå’Œä½ç½®
    'ğŸ¬': '[SHOP]',
    'ğŸª': '[STORE]',
    'ğŸ¢': '[OFFICE]',
    'ğŸ­': '[FACTORY]',
    'ğŸŒ': '[WEB]',
    'ğŸ“': '[LOC]',
    'ğŸ“Œ': '[PIN]',
    'ğŸ”—': '[LINK]',
    
    # å…¶ä»–ç¬¦å·
    'âœ¨': '[NEW]',
    'ğŸ¯': '[TARGET]',
    'âš¡': '[FLASH]',
    'ğŸ’ª': '[STRONG]',
    'ğŸ‘': '[GOOD]',
    'ğŸ‘': '[BAD]',
    'ğŸ¤–': '[BOT]',
    'ğŸ‘‹': '[WAVE]',
    'ğŸ‘¤': '[USER]',
    'ğŸ‘¥': '[USERS]',
    'ğŸ§ª': '[TEST]',
    'ğŸ”¬': '[TEST]',
    'ğŸ§©': '[PUZZLE]',
    'ğŸ¬': '[ACTION]',
    'ğŸª': '[EVENT]',
    'ğŸ·ï¸': '[TAG]',
    'ğŸ·': '[TAG]',
    'â­': '[*]',
    'â­•': '[O]',
    'ğŸ”´': '[RED]',
    'ğŸŸ¢': '[GREEN]',
    'ğŸŸ¡': '[YELLOW]',
    'ğŸ”µ': '[BLUE]',
    'âšª': '[WHITE]',
    'âš«': '[BLACK]',
    'ğŸŸ ': '[ORANGE]',
    'ğŸŸ£': '[PURPLE]',
    'ğŸ”¶': '[DIAMOND]',
    'ğŸ”·': '[DIAMOND]',
    'â–ª': '[*]',
    'â–«': '[*]',
    'â—¾': '[*]',
    'â—½': '[*]',
    'â—»ï¸': '[*]',
    'â—»': '[*]',
    'â—¼ï¸': '[*]',
    'â—¼': '[*]',
    'ğŸš¨': '[ALERT]',
    'ğŸ’¾': '[SAVE]',
    'ğŸ’»': '[PC]',
    'ğŸ“±': '[PHONE]',
    'ğŸ“¶': '[SIGNAL]',
    'ğŸ›œ': '[WIFI]',
    'ğŸ“': '[CALL]',
    'â˜ï¸': '[CALL]',
    'â˜': '[CALL]',
    'ğŸ–¥ï¸': '[DESKTOP]',
    'ğŸ–¥': '[DESKTOP]',
    'ğŸ–¨ï¸': '[PRINT]',
    'ğŸ–¨': '[PRINT]',
    'âŒ¨ï¸': '[KB]',
    'âŒ¨': '[KB]',
    'ğŸ–±ï¸': '[MOUSE]',
    'ğŸ–±': '[MOUSE]',
    'ğŸ’¿': '[CD]',
    'ğŸ“€': '[DVD]',
    'ğŸ®': '[GAME]',
    'ğŸ•¹ï¸': '[CTRL]',
    'ğŸ•¹': '[CTRL]',
    'ğŸµ': '[MUSIC]',
    'ğŸ¶': '[MUSIC]',
    'ğŸ“¢': '[LOUD]',
    'ğŸ”Š': '[SOUND]',
    'ğŸ”‰': '[SOUND]',
    'ğŸ”ˆ': '[SOUND]',
    'ğŸ”‡': '[MUTE]',
    'ğŸ™ï¸': '[MIC]',
    'ğŸ™': '[MIC]',
    'ğŸ¤': '[MIC]',
    'ğŸ§': '[AUDIO]',
    'ğŸ“»': '[RADIO]',
    'ğŸšï¸': '[SLIDER]',
    'ğŸš': '[SLIDER]',
    'ğŸ›ï¸': '[KNOB]',
    'ğŸ›': '[KNOB]',
    'ğŸ“·': '[CAM]',
    'ğŸ“¸': '[CAM]',
    'ğŸ“¹': '[VID]',
    'ğŸ¥': '[VID]',
    'ğŸ“½ï¸': '[PROJ]',
    'ğŸ“½': '[PROJ]',
    'ğŸï¸': '[FILM]',
    'ğŸ': '[FILM]',
    'ğŸ“º': '[TV]',
    'ğŸ”Œ': '[PLUG]',
    'ğŸ”‹': '[BAT]',
    'ğŸª«': '[BAT]',
    'âºï¸': '[REC]',
    'âº': '[REC]',
    'âï¸': '[EJECT]',
    'â': '[EJECT]',
    'ğŸ­': '[MASK]',
    'ğŸª': '[TENT]',
    'ğŸŒŸ': '[STAR]',
    'ğŸ’«': '[STAR]',
    'âœ³ï¸': '[*]',
    'âœ³': '[*]',
    'â‡ï¸': '[*]',
    'â‡': '[*]',
    'ğŸ†•': '[NEW]',
    'ğŸ†“': '[FREE]',
    'ğŸ†”': '[ID]',
    'ğŸ†—': '[OK]',
    'ğŸ†™': '[UP]',
    'ğŸ†š': '[VS]',
    'ğŸˆ': '[JPN]',
    'ğŸˆ‚ï¸': '[JPN]',
    'ğŸˆ¯': '[JPN]',
    'ğŸˆš': '[JPN]',
    'ğŸˆ²': '[JPN]',
    'ğŸˆ³': '[JPN]',
    'ğŸˆ´': '[JPN]',
    'ğŸˆµ': '[JPN]',
    'ğŸˆ¶': '[JPN]',
    'ğŸˆ·ï¸': '[JPN]',
    'ğŸˆ¸': '[JPN]',
    'ğŸˆ¹': '[JPN]',
    'ğŸˆº': '[JPN]',
    'ğŸ‰': '[JPN]',
    'ğŸ‰‘': '[JPN]',
    'ãŠ—ï¸': '[JPN]',
    'ãŠ™ï¸': '[JPN]',
    'ğŸ”¸': '[*]',
    'ğŸ”¹': '[*]',
    'ğŸ”º': '[^]',
    'ğŸ”»': '[v]',
    'ğŸ”˜': '[o]',
    'ğŸ”²': '[ ]',
    'ğŸ”³': '[x]',
    'ğŸ”œ': '[SOON]',
    'ğŸ”': '[TOP]',
    'ğŸ”': '[18+]',
    'ğŸ” ': '[ABC]',
    'ğŸ”¡': '[abc]',
    'ğŸ”¢': '[123]',
    'ğŸ”£': '[#]',
    'ğŸ”¤': '[abc]',
    'ğŸ…°ï¸': '[A]',
    'ğŸ…±ï¸': '[B]',
    'ğŸ…¾ï¸': '[O]',
    'ğŸ…¿ï¸': '[P]',
    'â„¹ï¸': '[i]',
    'â„¹': '[i]',
    'ğŸ”€': '[SHUFFLE]',
    'ğŸ”': '[LOOP]',
    'ğŸ”‚': '[LOOP1]',
    'ğŸ”ƒ': '[RELOAD]',
    'ğŸ”„': '[RETRY]',
    'ğŸ†': '[AB]',
    'ğŸ†‘': '[CL]',
    'ğŸˆ': '[KO]',
    'ğŸ”…': '[DIM]',
    'ğŸ”†': '[BRIGHT]',
    'ğŸ“µ': '[NO PHONE]',
    'ğŸš«': '[NO]',
    'â›”': '[STOP]',
    'ğŸš·': '[NO ENTRY]',
    'ğŸš¯': '[NO LITTER]',
    'ğŸš±': '[NO WATER]',
    'ğŸš³': '[NO BIKE]',
    'ğŸš­': '[NO SMOKE]',
    'â—': '[!]',
    'â•': '[!]',
    'â“': '[?]',
    'â”': '[?]',
    'â€¼ï¸': '[!!]',
    'â€¼': '[!!]',
    'â‰ï¸': '[!?]',
    'â‰': '[!?]',
    'ğŸ”±': '[TRIDENT]',
    'ğŸ“›': '[NAME]',
    'ğŸ”°': '[JPN]',
    'â­•': '[O]',
    'âœ…': '[OK]',
    'â˜‘ï¸': '[OK]',
    'â˜‘': '[OK]',
    'âœ”ï¸': '[OK]',
    'âœ”': '[OK]',
    'â': '[X]',
    'â•': '[+]',
    'â–': '[-]',
    'â—': '[/]',
    'âœ–ï¸': '[x]',
    'âœ–': '[x]',
    'ğŸ’²': '[$]',
    'ğŸ’±': '[EXCHANGE]',
    'â„¢ï¸': '[TM]',
    'â„¢': '[TM]',
    'Â©ï¸': '[C]',
    'Â©': '[C]',
    'Â®ï¸': '[R]',
    'Â®': '[R]',
    'ğŸŒ€': '[SPIN]',
    'â°': '[LOOP]',
    'â¿': '[LOOP]',
    'ğŸ”š': '[END]',
    'ğŸ”™': '[BACK]',
    'ğŸ”›': '[ON]',
    'ğŸ”œ': '[SOON]',
    'ğŸ”': '[TOP]',
    
    # çœç•¥å·
    'â€¦': '...',
    
    # ç‰¹æ®Šç¬¦å·
    'â¡': '->',
    'â¬…': '<-',
    'â¬†': '^',
    'â¬‡': 'v',
    'â†”': '<->',
    'â†•': '^v',
    'â†—ï¸': '[NE]',
    'â†—': '[NE]',
    'â†˜ï¸': '[SE]',
    'â†˜': '[SE]',
    'â†™ï¸': '[SW]',
    'â†™': '[SW]',
    'â†–ï¸': '[NW]',
    'â†–': '[NW]',
    'â†©ï¸': '[BACK]',
    'â†©': '[BACK]',
    'â†ªï¸': '[FWD]',
    'â†ª': '[FWD]',
    'â¤´ï¸': '[UP]',
    'â¤´': '[UP]',
    'â¤µï¸': '[DOWN]',
    'â¤µ': '[DOWN]',
    'ğŸ”ƒ': '[RELOAD]',
    'ğŸ”™': '[BACK]',
    'ğŸ”š': '[END]',
    'ğŸ”›': '[ON]',
    'ğŸ”œ': '[SOON]',
    'ğŸ”': '[TOP]',
    
    # æ‰‹åŠ¿
    'ğŸ‘‹': '[HI]',
    'ğŸ¤š': '[STOP]',
    'ğŸ–ï¸': '[STOP]',
    'ğŸ–': '[STOP]',
    'âœ‹': '[STOP]',
    'ğŸ––': '[VULCAN]',
    'ğŸ‘Œ': '[OK]',
    'ğŸ¤Œ': '[PINCH]',
    'ğŸ¤': '[SMALL]',
    'âœŒï¸': '[V]',
    'âœŒ': '[V]',
    'ğŸ¤': '[CROSS]',
    'ğŸ¤Ÿ': '[LOVE]',
    'ğŸ¤˜': '[ROCK]',
    'ğŸ¤™': '[CALL]',
    'ğŸ‘†': '[UP]',
    'ğŸ‘‡': '[DOWN]',
    'ğŸ‘ˆ': '[LEFT]',
    'ğŸ‘‰': '[RIGHT]',
    'ğŸ‘Š': '[PUNCH]',
    'âœŠ': '[FIST]',
    'ğŸ¤›': '[FIST L]',
    'ğŸ¤œ': '[FIST R]',
    'ğŸ‘': '[CLAP]',
    'ğŸ™Œ': '[RAISE]',
    'ğŸ‘': '[OPEN]',
    'ğŸ¤²': '[PALMS]',
    'ğŸ¤': '[SHAKE]',
    'ğŸ™': '[PRAY]',
    'âœï¸': '[WRITE]',
    'âœ': '[WRITE]',
    'ğŸ’…': '[NAIL]',
    'ğŸ¤³': '[SELFIE]',
    'ğŸ’ª': '[MUSCLE]',
    
    # é’Ÿè¡¨
    'ğŸ•': '[1:00]',
    'ğŸ•‘': '[2:00]',
    'ğŸ•’': '[3:00]',
    'ğŸ•“': '[4:00]',
    'ğŸ•”': '[5:00]',
    'ğŸ••': '[6:00]',
    'ğŸ•–': '[7:00]',
    'ğŸ•—': '[8:00]',
    'ğŸ•˜': '[9:00]',
    'ğŸ•™': '[10:00]',
    'ğŸ•š': '[11:00]',
    'ğŸ•›': '[12:00]',
    'ğŸ•œ': '[1:30]',
    'ğŸ•': '[2:30]',
    'ğŸ•': '[3:30]',
    'ğŸ•Ÿ': '[4:30]',
    'ğŸ• ': '[5:30]',
    'ğŸ•¡': '[6:30]',
    'ğŸ•¢': '[7:30]',
    'ğŸ•£': '[8:30]',
    'ğŸ•¤': '[9:30]',
    'ğŸ•¥': '[10:30]',
    'ğŸ•¦': '[11:30]',
    'ğŸ•§': '[12:30]',
    
    # è¿è¾“
    'ğŸš—': '[CAR]',
    'ğŸš™': '[SUV]',
    'ğŸšŒ': '[BUS]',
    'ğŸš': '[TROLLEY]',
    'ğŸï¸': '[RACE]',
    'ğŸ': '[RACE]',
    'ğŸš“': '[POLICE]',
    'ğŸš‘': '[AMBULANCE]',
    'ğŸš’': '[FIRE]',
    'ğŸš': '[VAN]',
    'ğŸ›»': '[TRUCK]',
    'ğŸšš': '[TRUCK]',
    'ğŸš›': '[SEMI]',
    'ğŸšœ': '[TRACTOR]',
    'ğŸ›´': '[SCOOTER]',
    'ğŸš²': '[BIKE]',
    'ğŸ›µ': '[MOPED]',
    'ğŸï¸': '[MOTO]',
    'ğŸ': '[MOTO]',
    'ğŸ›º': '[RICKSHAW]',
    'ğŸš”': '[POLICE]',
    'ğŸš': '[BUS]',
    'ğŸš˜': '[CAR]',
    'ğŸš–': '[TAXI]',
    'ğŸ›': '[TIRE]',
    'ğŸš¡': '[CABLE]',
    'ğŸš ': '[CABLE]',
    'ğŸšŸ': '[TRAM]',
    'ğŸšƒ': '[RAIL]',
    'ğŸš‹': '[TRAM]',
    'ğŸš': '[TRAIN]',
    'ğŸš': '[MONO]',
    'ğŸš„': '[HSR]',
    'ğŸš…': '[HSR]',
    'ğŸšˆ': '[METRO]',
    'ğŸš‚': '[STEAM]',
    'ğŸš†': '[TRAIN]',
    'ğŸš‡': '[METRO]',
    'ğŸšŠ': '[TRAM]',
    'ğŸš‰': '[STATION]',
    'âœˆï¸': '[PLANE]',
    'âœˆ': '[PLANE]',
    'ğŸ›«': '[DEPART]',
    'ğŸ›¬': '[ARRIVE]',
    'ğŸ›©ï¸': '[PLANE]',
    'ğŸ›©': '[PLANE]',
    'ğŸ’º': '[SEAT]',
    'ğŸ›°ï¸': '[SAT]',
    'ğŸ›°': '[SAT]',
    'ğŸš€': '[ROCKET]',
    'ğŸ›¸': '[UFO]',
    'ğŸš': '[HELI]',
    'ğŸ›¶': '[CANOE]',
    'â›µ': '[SAIL]',
    'ğŸš¤': '[BOAT]',
    'ğŸ›¥ï¸': '[BOAT]',
    'ğŸ›¥': '[BOAT]',
    'ğŸ›³ï¸': '[SHIP]',
    'ğŸ›³': '[SHIP]',
    'â›´ï¸': '[FERRY]',
    'â›´': '[FERRY]',
    'ğŸš¢': '[SHIP]',
    'âš“': '[ANCHOR]',
    'ğŸ›Ÿ': '[RING]',
    'â›½': '[GAS]',
    'ğŸš§': '[ROAD]',
    'ğŸš¦': '[LIGHT]',
    'ğŸš¥': '[LIGHT]',
    'ğŸ›‘': '[STOP]',
    'ğŸš': '[STOP]',
    
    # å˜ä½“é€‰æ‹©å™¨å¤„ç† (FE0F)
    'ï¸': '',  # å˜ä½“é€‰æ‹©ç¬¦ï¼Œç›´æ¥åˆ é™¤
    '\ufe0f': '',  # Unicodeå˜ä½“é€‰æ‹©ç¬¦
    
    # è¡¥å……emoji
    'ğŸ›': '[SHOP]',
    'ğŸ›ï¸': '[SHOP]',
    'ğŸ’°': '[MONEY]',
    'ğŸ’µ': '[MONEY]',
    'ğŸ’´': '[MONEY]',
    'ğŸ’¶': '[MONEY]',
    'ğŸ’·': '[MONEY]',
    'ğŸ’¸': '[MONEY]',
    'ğŸ’³': '[CARD]',
    'ğŸ§­': '[COMPASS]',
    'ğŸ“–': '[BOOK]',
    'ğŸ“•': '[BOOK]',
    'ğŸ“—': '[BOOK]',
    'ğŸ“˜': '[BOOK]',
    'ğŸ“™': '[BOOK]',
    'ğŸ“š': '[DOCS]',
    'ğŸ““': '[NOTEBOOK]',
    'ğŸ“’': '[NOTEBOOK]',
    'ğŸ“”': '[NOTEBOOK]',
    'ğŸ“•': '[BOOK]',
    'ğŸ–¼': '[IMG]',
    'ğŸ–¼ï¸': '[IMG]',
    'ğŸ–¼': '[IMG]',
    'ğŸ–¼ï¸': '[IMG]',
    'ğŸ‡¨ğŸ‡³': '[CN]',
    'ğŸ‡ºğŸ‡¸': '[US]',
    'ğŸ‡¬ğŸ‡§': '[UK]',
    'ğŸ‡¯ğŸ‡µ': '[JP]',
    'ğŸ‡°ğŸ‡·': '[KR]',
    'ğŸ‡©ğŸ‡ª': '[DE]',
    'ğŸ‡«ğŸ‡·': '[FR]',
    'ğŸ‡ªğŸ‡¸': '[ES]',
    'ğŸ‡®ğŸ‡¹': '[IT]',
    'ğŸ‡·ğŸ‡º': '[RU]',
    'ğŸ‡§ğŸ‡·': '[BR]',
    'ğŸ‡®ğŸ‡³': '[IN]',
    'ğŸ‡¸ğŸ‡¬': '[SG]',
    'ğŸ‡²ğŸ‡¾': '[MY]',
    'ğŸ‡¹ğŸ‡­': '[TH]',
    'ğŸ‡»ğŸ‡³': '[VN]',
    'ğŸ‡µğŸ‡­': '[PH]',
    'ğŸ‡®ğŸ‡©': '[ID]',
    'ğŸ‡¹ğŸ‡¼': '[TW]',
    'ğŸ‡­ğŸ‡°': '[HK]',
    'ğŸ§¹': '[CLEAN]',
    'ğŸ§º': '[BASKET]',
    'ğŸ§»': '[ROLL]',
    'ğŸ§¼': '[SOAP]',
    'ğŸ§½': '[SPONGE]',
    'ğŸ”¥': '[FIRE]',
    'ğŸ’¥': '[BOOM]',
    'ğŸ’¢': '[ANGER]',
    'ğŸ’¦': '[SWEAT]',
    'ğŸ’§': '[DROP]',
    'ğŸ’¨': '[DASH]',
    'ğŸ“œ': '[SCROLL]',
    'ğŸ“ƒ': '[DOC]',
    'ğŸ“„': '[FILE]',
    'ğŸ“‘': '[BOOKMARK]',
    'ğŸ·': '[TAG]',
    'âœ': '[EDIT]',
    'âœï¸': '[EDIT]',
    'âœ’': '[PEN]',
    'âœ’ï¸': '[PEN]',
    'ğŸ–Š': '[PEN]',
    'ğŸ–Šï¸': '[PEN]',
    'ğŸ–‹': '[PEN]',
    'ğŸ–‹ï¸': '[PEN]',
    'ğŸ–Œ': '[BRUSH]',
    'ğŸ–Œï¸': '[BRUSH]',
    'ğŸ–': '[CRAYON]',
    'ğŸ–ï¸': '[CRAYON]',
    'ğŸ—‘': '[DEL]',
    'ğŸ—‘ï¸': '[DEL]',
    'ğŸ—‚': '[FILES]',
    'ğŸ—ƒ': '[ARCHIVE]',
    'ğŸ—„': '[CABINET]',
    'ğŸ—„ï¸': '[CABINET]',
    'ğŸ§¾': '[RECEIPT]',
    'ğŸ§¾ï¸': '[RECEIPT]',
    'ğŸ§ ': '[BRAIN]',
    'ğŸ§¬': '[DNA]',
    'ğŸ¦·': '[TOOTH]',
    'ğŸ¦´': '[BONE]',
    'ğŸ‘ï¸â€ğŸ—¨ï¸': '[EYE]',
    'ğŸ¨': '[ART]',
    'ğŸ­': '[MASK]',
    'ğŸª': '[TENT]',
    'ğŸ¤': '[MIC]',
    'ğŸ§': '[AUDIO]',
    'ğŸ¼': '[MUSIC]',
    'ğŸ¹': '[PIANO]',
    'ğŸ¥': '[DRUM]',
    'ğŸ·': '[SAX]',
    'ğŸº': '[TRUMPET]',
    'ğŸ¸': '[GUITAR]',
    'ğŸª•': '[BANJO]',
    'ğŸ»': '[VIOLIN]',
    'ğŸ²': '[DICE]',
    'â™Ÿ': '[CHESS]',
    'â™Ÿï¸': '[CHESS]',
    'ğŸ¯': '[TARGET]',
    'ğŸ³': '[BOWLING]',
    'ğŸ®': '[GAME]',
    'ğŸ•¹': '[CTRL]',
    'ğŸ°': '[SLOT]',
    'ğŸ§©': '[PUZZLE]',
    'â†³': ' ->',
    'â†µ': '[ENTER]',
    'â†²': '[ENTER]',
    'â': '[ENTER]',
    'ğŸŒ': '[GLOBE]',
    'ğŸŒ': '[GLOBE]',
    'ğŸŒ': '[GLOBE]',
    'ğŸ—º': '[MAP]',
    'ğŸ—ºï¸': '[MAP]',
    'ğŸ§­': '[COMPASS]',
    'ğŸ”': '[MOUNTAIN]',
    'ğŸ”ï¸': '[MOUNTAIN]',
    'â›°': '[MOUNTAIN]',
    'â›°ï¸': '[MOUNTAIN]',
    'ğŸŒ‹': '[VOLCANO]',
    'ğŸ—»': '[MT]',
    'ğŸ•': '[CAMP]',
    'ğŸ•ï¸': '[CAMP]',
    'ğŸ–': '[BEACH]',
    'ğŸ–ï¸': '[BEACH]',
    'ğŸœ': '[DESERT]',
    'ğŸœï¸': '[DESERT]',
    'ğŸ': '[ISLAND]',
    'ğŸï¸': '[ISLAND]',
    'ğŸ': '[PARK]',
    'ğŸï¸': '[PARK]',
    'ğŸŸ': '[STADIUM]',
    'ğŸŸï¸': '[STADIUM]',
    'ğŸ›': '[GOVT]',
    'ğŸ›ï¸': '[GOVT]',
    'ğŸ¦': '[*]',
    'ğŸ¦‘': '[*]',
    'ğŸ¦€': '[*]',
    'ğŸ¦': '[*]',
    'ğŸ¦ª': '[*]',
    
    # æ›´å¤šè¡¥å……
    'ğŸ›': '[BELL]',
    'ğŸ›ï¸': '[BELL]',
    'â­': '[NEXT]',
    'â­ï¸': '[NEXT]',
    'â®': '[PREV]',
    'â®ï¸': '[PREV]',
    'â¯': '[PLAY]',
    'â¯ï¸': '[PLAY]',
    'âª': '[REWIND]',
    'â¬': '[FAST DOWN]',
    'â«': '[FAST UP]',
    'ğŸ”›': '[ON]',
    'ğŸ”œ': '[SOON]',
    'ğŸ”': '[TOP]',
    'ğŸ”™': '[BACK]',
    'ğŸ”š': '[END]',
    'ğŸ—“': '[CAL]',
    'ğŸ—“ï¸': '[CAL]',
}

# Emoji æ£€æµ‹æ­£åˆ™è¡¨è¾¾å¼
# åŒ¹é…å¸¸è§çš„ emoji å­—ç¬¦èŒƒå›´
EMOJI_PATTERN = re.compile(
    "["
    "\U0001F600-\U0001F64F"  # è¡¨æƒ…
    "\U0001F300-\U0001F5FF"  # ç¬¦å·å’Œå›¾æ ‡
    "\U0001F680-\U0001F6FF"  # äº¤é€šå’Œåœ°å›¾
    "\U0001F1E0-\U0001F1FF"  # æ——å¸œ
    "\U00002702-\U000027B0"  # æ‚é¡¹ç¬¦å·
    "\U0001F900-\U0001F9FF"  # è¡¥å……ç¬¦å·
    "\U00002600-\U000026FF"  # æ‚é¡¹ç¬¦å·
    "\U00002B50-\U00002B55"  # æ˜Ÿæ˜Ÿ
    "\u2700-\u27BF"          # è£…é¥°ç¬¦å·
    "\u2190-\u21FF"          # ç®­å¤´
    "\u2300-\u23FF"          # æŠ€æœ¯ç¬¦å·
    "\u25A0-\u25FF"          # å‡ ä½•å½¢çŠ¶
    "\u2600-\u26FF"          # æ‚é¡¹ç¬¦å·
    "\u2700-\u27BF"          # è£…é¥°ç¬¦å·
    "\u2900-\u297F"          # è¡¥å……ç®­å¤´
    "\u231A-\u231B"          # æ—¶é’Ÿ
    "\u23E9-\u23F3"          # åª’ä½“æ§åˆ¶
    "\u23F8-\u23FA"          # åª’ä½“æ§åˆ¶
    "\u25AA-\u25AB"          # æ–¹å½¢
    "\u25B6\u25C0"           # æ’­æ”¾
    "\u25FB-\u25FE"          # æ–¹å½¢
    "\u2600-\u2604"          # å¤©æ°”
    "\u260E\u2611"           # ç”µè¯ã€å¤é€‰æ¡†
    "\u2614-\u2615"          # é›¨ä¼ã€å’–å•¡
    "\u2618\u261D"           # æ¤ç‰©ã€æ‰‹æŒ‡
    "\u2620\u2622-\u2623"    # éª·é«…ã€è¾å°„
    "\u2626\u262A"           # å®—æ•™
    "\u262E-\u262F"          # å’Œå¹³
    "\u2638-\u263A"          # è¡¨æƒ…
    "\u2640\u2642"           # æ€§åˆ«
    "\u2648-\u2653"          # æ˜Ÿåº§
    "\u2660\u2663\u2665-\u2666"  # æ‰‘å…‹ç‰Œ
    "\u2668\u267B\u267F"     # æ¸©æ³‰ã€å›æ”¶ã€æ®‹ç–¾
    "\u2692-\u2694\u2696-\u2697"  # å·¥å…·
    "\u2699\u269B-\u269C"    # é½¿è½®
    "\u26A0-\u26A1"          # è­¦å‘Šã€é—ªç”µ
    "\u26AA-\u26AB"          # åœ†åœˆ
    "\u26B0-\u26B1"          # æ£ºæ
    "\u26BD-\u26BE"          # è¿åŠ¨
    "\u26C4-\u26C5"          # å¤©æ°”
    "\u26CE\u26CF"           # æ˜Ÿåº§ã€å·¥å…·
    "\u26D1\u26D3-\u26D4"    # å¤´ç›”ã€ç¦æ­¢
    "\u26E9-\u26EA"          # å»ºç­‘
    "\u26F0-\u26F5"          # äº¤é€š
    "\u26F7-\u26FA"          # æ´»åŠ¨
    "\u26FD"                 # åŠ æ²¹ç«™
    "âœ…âœ“âœ—âŒâš ï¸ğŸ”â–¶âœâ©ğŸ¬ğŸ“…â±ï¸ğŸš€ğŸ‰"
    "â€¦"
    "]+"
)


def find_emoji_in_file(file_path: Path) -> list[tuple[int, str, str]]:
    """åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾ emoji å­—ç¬¦
    
    Returns:
        List of (line_number, line_content, matched_emoji)
    """
    results = []
    try:
        content = file_path.read_text(encoding='utf-8')
        for i, line in enumerate(content.split('\n'), 1):
            # æ£€æŸ¥å·²çŸ¥ emoji
            for emoji in EMOJI_REPLACEMENTS:
                if emoji in line:
                    results.append((i, line.strip()[:100], emoji))
            # æ£€æŸ¥å…¶ä»– emoji
            matches = EMOJI_PATTERN.findall(line)
            for match in matches:
                if match not in EMOJI_REPLACEMENTS:
                    results.append((i, line.strip()[:100], match))
    except Exception as e:
        print(f"[WARN] Cannot read {file_path}: {e}")
    return results


def fix_emoji_in_file(file_path: Path) -> int:
    """æ›¿æ¢æ–‡ä»¶ä¸­çš„ emoji å­—ç¬¦
    
    Returns:
        æ›¿æ¢çš„æ•°é‡
    """
    try:
        content = file_path.read_text(encoding='utf-8')
        original = content
        
        for emoji, replacement in EMOJI_REPLACEMENTS.items():
            content = content.replace(emoji, replacement)
        
        if content != original:
            file_path.write_text(content, encoding='utf-8')
            return len([e for e in EMOJI_REPLACEMENTS if e in original])
        return 0
    except Exception as e:
        print(f"[FAIL] Cannot fix {file_path}: {e}")
        return 0


def main():
    fix_mode = '--fix' in sys.argv
    
    # æ‰«æç›®å½•
    scan_dirs = ['modules', 'backend', 'tools']
    exclude_patterns = ['node_modules', '__pycache__', '.git', 'venv', '.venv', 'backups']
    
    total_files = 0
    files_with_emoji = 0
    total_fixes = 0
    
    print("=" * 60)
    print("Emoji æ£€æµ‹éªŒè¯è„šæœ¬")
    print("=" * 60)
    
    for scan_dir in scan_dirs:
        scan_path = Path(scan_dir)
        if not scan_path.exists():
            continue
            
        for file_path in scan_path.rglob('*.py'):
            # è·³è¿‡æ’é™¤çš„ç›®å½•
            if any(p in str(file_path) for p in exclude_patterns):
                continue
            
            total_files += 1
            results = find_emoji_in_file(file_path)
            
            if results:
                files_with_emoji += 1
                print(f"\n[WARN] {file_path}")
                for line_num, line_content, emoji in results[:5]:  # åªæ˜¾ç¤ºå‰5ä¸ª
                    # å°† emoji è½¬æ¢ä¸º Unicode ç ç‚¹è¡¨ç¤ºï¼Œé¿å… GBK ç¼–ç é”™è¯¯
                    emoji_repr = emoji.encode('unicode-escape').decode('ascii')
                    line_safe = line_content[:60].encode('ascii', 'replace').decode('ascii')
                    print(f"  L{line_num}: {emoji_repr} -> {line_safe}...")
                
                if fix_mode:
                    fixed = fix_emoji_in_file(file_path)
                    total_fixes += fixed
                    print(f"  [OK] Fixed {fixed} emoji(s)")
    
    print("\n" + "=" * 60)
    print(f"æ‰«æå®Œæˆ: {total_files} æ–‡ä»¶")
    print(f"åŒ…å« Emoji çš„æ–‡ä»¶: {files_with_emoji}")
    
    if fix_mode:
        print(f"å·²ä¿®å¤: {total_fixes} å¤„")
    else:
        if files_with_emoji > 0:
            print(f"\n[TIP] è¿è¡Œ 'python scripts/verify_no_emoji.py --fix' è‡ªåŠ¨ä¿®å¤")
    
    # è¿”å›çŠ¶æ€ç 
    if files_with_emoji > 0 and not fix_mode:
        print("\n[FAIL] æ£€æµ‹åˆ° emoji å­—ç¬¦ï¼Œå¯èƒ½å¯¼è‡´ Windows ç¼–ç é”™è¯¯")
        sys.exit(1)
    else:
        print("\n[OK] éªŒè¯é€šè¿‡")
        sys.exit(0)


if __name__ == "__main__":
    main()
